(function(){function q(a,f){a.prototype=Object.create(f.prototype);a.prototype.constructor=a}function r(a,f,g){Object.defineProperty(a,f,{get:g,set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:f})})}function u(a,f){Object.defineProperty(a,"propagating",{get:f,set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:"propagating"})})}
function y(a,f,g){Object.defineProperty(a,f,{get:function(){return g},set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:f})})}function BotanEvent(a,f){var g=!1,k=!1;y(this,"propagate",function(){k||(g=!0);k=!0});y(this,"stopPropagating",function(){g=!1});y(this,"type",a);u(this,function(){return g});y(this,"data",f);this.setTarget=function(a){y(this,"target",a);this.setTarget=void 0}.bind(this)}
function D(){function a(){this.da.propagate();for(var a in this.stack)if(this.da.propagating)this.stack[a](this.da);this.da.stopPropagating()}function f(a){g[a]||(g[a]=[]);return g[a]}var g={},k=this;this.addEventListener=function(a,e){var b=f(a);b[b.length]=e};this.removeEventListener=function(a,e){var b=f(a),h=b.indexOf(e);0>h||delete b[h]};this.dispatchEvent=function(c){var e=f(c.type);c.setTarget&&c.setTarget(k);setTimeout(a.bind({da:c,stack:e}),0)}}function G(){D.call(this)}G.prototype=[];
var H={},I={},J={},K=window.BotanJS,BotanJS=null,L=null,N=null;K&&(BotanJS=K.sg[0],L=K.sg[1],N=K.sg[2]);BotanJS=BotanJS||function(){var a=0,f=[],g=[],k=new D,c={write:function(e){f[f.length]=e}};y(c,"read",function(){return f[a++]});y(c,"end",function(){return f.length<=a});y(k,"log",c);y(k,"define",function(e){g[g.length]=e});y(k,"getDef",function(){return g.slice()});return k}();
L=L||function(a){if(I[a])return I[a];for(var f=a.split("."),g=f.length,k=H,c=0;c<g;c++)k[f[c]]=k[f[c]]||{},k=k[f[c]];k.Qa=[];nsObj=new G;nsObj[1]=function(e,b,h){this.m[b]||(this.m[b]=[e,h],e=new BotanEvent("NS_EXPORT",{name:this.O+"."+b,type:e}),BotanJS.dispatchEvent(e))}.bind({m:k,O:a});nsObj[0]=function(e){if(!this.m[e])throw Error("["+this.O+"] Invoke failed: "+e+" does not exists");return this.m[e][1]}.bind({m:k,O:a});nsObj[10]=function(e,b){this.Qa[e]=b}.bind(k);nsObj[11]=function(e,b){throw Error("["+
this.O+(b?"."+b:"")+"] "+e);}.bind({O:a});BotanJS.dispatchEvent(new BotanEvent("NS_INIT",a));return I[a]=nsObj};
N=N||function(a,f){var g=a.replace(".*","");I[g]&&I[g].dispatchEvent(new BotanEvent("NS_IMPORT",e));if(!f&&J[a])return J[a];for(var k=a.split("."),c=k.length,e=H,g=!1,b=0;b<c;b++){if("*"==k[b]){g=!0;break}e=e[k[b]];if(!e)throw Error("No such class: "+a);}if(e instanceof Array&&"*"!=k[b])return g=null,g=10==e[0]?e[1]():e[1],J[a]=g;k={};for(b in e)c=e[b],c instanceof Array&&(g&&2==c[0]?k[b]=c[1]:3==c[0]?k[b]=c[1]:0==c[0]?Object.defineProperty(k,b,{get:function(){return this.m[this.c][1]}.bind({c:b,
m:e}),set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:b})}):1==c[0]?Object.defineProperty(k,b,{get:function(){return this.m[this.c][1]()}.bind({c:b,m:e}),set:function(b){this.m[this.c][1](b)}.bind({c:b,m:e})}):10==c[0]&&Object.defineProperty(k,b,{get:c[1],set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:b})}));return J[a]=k};window.BotanJS={};window.BotanJS.version="1.0.0b";window.BotanJS.codename="Botanical framework.js";
window.BotanJS["import"]=function(a){try{return N(a)}catch(f){if(K)return K["import"](a);throw f;}};window.BotanJS.sg=[BotanJS,L,N];BotanJS.define("System.utils.IKey");
(function(){function a(g,k){g&&"string"!=typeof g||(this.keyName=g,this.keyValue=k instanceof a?k:void 0!=k?String(k):"",this.keyName=this.keyName,this.keyValue=this.keyValue)}var f=L("System.utils");a.prototype.keyName="";a.prototype.keyValue="";y(a,"quickDef",function(){var g=arguments.length;if(0!=g%2)f[11]("Invalid Definition Count","IKey");for(var k=[],c=0;c<g;c+=2)k[k.length]=new a(arguments[c],arguments[c+1]);return k});f[1](2,"IKey",a)})();BotanJS.define("System.utils.Perf");
(function(){for(var a=L("System.utils.Perf"),f=[],g=0;256>g;g++)f[g]=(16>g?"0":"")+g.toString(16);a[1](10,"uuid",function(){var a=4294967295*Math.random()|0,c=4294967295*Math.random()|0,e=4294967295*Math.random()|0,b=4294967295*Math.random()|0;return f[a&255]+f[a>>8&255]+f[a>>16&255]+f[a>>24&255]+"-"+f[c&255]+f[c>>8&255]+"-"+f[c>>16&15|64]+f[c>>24&255]+"-"+f[e&63|128]+f[e>>8&255]+"-"+f[e>>16&255]+f[e>>24&255]+f[b&255]+f[b>>8&255]+f[b>>16&255]+f[b>>24&255]});a[1](3,"CountSubstr",function(a,c){if(0>=
c.length)return a.length+1;for(var e=0,b=a.indexOf(c);0<=b;b=a.indexOf(c,b))e++,b++;return e});a[1](3,"ArrayReverse",function(a){for(var c=null,e=a.length,b=null,c=0,b=e-1;c<b;c+=1,--b){var e=a[c],h=a[b],e=e^h,h=h^e,e=e^h;a[c]=e;a[b]=h}})})();BotanJS.define("System.Global");
(function(){var a=L("System.Global"),f=Boolean(document.all),g=window.allowed_origins||[],k=window.location.href.match(/^https:\/\//);a[1](10,"debug",function(){return window.debugEnv&&window.debugEnv});a[1](0,"IE",f);a[1](0,"ALLOWED_ORIGINS",g);a[1](0,"SECURE_HTTP",k)})();BotanJS.define("Dandelion");
(function(){function a(){if(p)return!0;try{return p=N("Dandelion.IDOMElement"),!0}catch(d){}return!1}function f(d,b){if(b&&a()){for(var m=d.length,h=[],e=0;e<m;e++)h[e]=p(d[e]);return h}return d}function g(d,b){d&&b(d)&&d.parentNode&&g(d.parentNode,b)}function k(d,b){return b(d)?d:d.parentNode&&k(d.parentNode,b)}function c(d){return document.createTextNode(d)}function e(h,e,a,p,c){h=document.createElement(h||"div");e&&(h.id=e);a&&(d?h.className=a:h.setAttribute("class",a));if(c)if(c instanceof Array)for(var k in c)h.setAttribute(c[k].keyName,
c[k].keyValue);else c instanceof m&&h.setAttribute(c.keyName,c.keyValue);p&&b(h,p);return h}function b(d,m){if(m instanceof Array)for(var h=m.length,e=0;e<h;e++)m[e]&&b(d,m[e]);else"string"==typeof m?d.appendChild(c(m)):m&&d.appendChild(m)}var h=L("Dandelion"),d=N("System.Global.IE"),m=N("System.utils.IKey"),p;h[1](3,"wrap",e);h[1](3,"wrapc",function(d,b,m){return e(!1,!1,d,b,m)});h[1](3,"wrape",function(d,b){return e(!1,!1,!1,d,b)});h[1](3,"wrapne",function(d,b,m){return e(d,!1,!1,b,m)});h[1](3,
"wrapna",function(d,b){return e(d,!1,!1,!1,b)});h[1](3,"textNode",c);h[1](3,"bubbleUp",k);h[1](3,"chainUpApply",g);h[1](3,"id",function(d,b){var m=document.getElementById(d);return m?b&&a()?p(m):m:m});h[1](3,"tag",function(d,b,m){m=void 0===m?document:m;return f(m.getElementsByTagName(d),b)});h[1](3,"name",function(d,b,m){m=void 0===m?document:m;return f(m.getElementsByName(d),b)});h[1](3,"glass",function(d,m,b){b=void 0===b?document:b;return f(b.getElementsByClassName(d),m)})})();BotanJS.define("System.utils.EventKey");
(function(){function a(a,c){g.call(this,a,c);this.type=a.toLowerCase();this.handler=c}var f=L("System.utils"),g=f[0]("IKey");q(a,g);a.prototype.type="";a.prototype.handler=null;f[1](2,"EventKey",a)})();BotanJS.define("Dandelion.IDOMObject");
(function(){function a(c,e){if(c instanceof a)return c;if(e)this.addEventListener=this.addEventListener.bind(c),this.addEventListeners=this.addEventListeners.bind(this),this.hasListener=this.hasListener.bind(c),this.removeEventListener=this.removeEventListener.bind(c);else{if(c)return new a(c,!0);throw Error("[Dandelion.IDOMObject] Invalid argument");}}function f(){}var g=L("Dandelion"),k=N("System.utils.EventKey");f.prototype.indexOf=function(a){for(var e=this.length,b=0;b<e;b++){var h=this[b];if(h.type==
a.type&&h.handler==a.handler)return b}return-1};q(f,Array);a.prototype.hasListener=function(a){return a instanceof k&&this.l&&-1!=this.l.indexOf(a)?this.l[this.l.indexOf(a)]:null};a.prototype.addEventListener=function(a,e){var b;if("string"==typeof a&&e)b=new k(a,e);else if(a instanceof k)b=a;else return!1;if(this.l)if(0>this.l.indexOf(b))this.l.push(b);else return!1;else this.l=new f,this.l[0]=b;this.addEventListener?this.addEventListener(b.type,b.handler,!1):this.attachEvent?this.attachEvent("on"+
b.type,b.handler):this["on"+b.type]=b.handler;return!0};a.prototype.addEventListeners=function(a){if(a instanceof Array)for(var e in a)this.addEventListener(a[e])};a.prototype.removeEventListener=function(a,e){e&&(a=new k(a,e));this.l&&delete this.l[this.l.indexOf(a)];this.removeEventListener?this.removeEventListener(a.type,a.handler):this.detachEvent?this.detachEvent("on"+a.type,a.handler):this["on"+a.type]=null};g[1](2,"IDOMObject",a)})();BotanJS.define("Dandelion.IDOMElement");
(function(){function a(d){d=typeof d;return"number"==d?g:"string"==d?f:k}function f(d,b){return d.nodeName==b}function g(d,b){return d.nodeType==b}function k(){return!1}function c(b,e){if(b instanceof c)return b;if(e)d.call(this,b,!0),this.getDAttribute=this.getDAttribute.bind(b),this.lootChildren=this.lootChildren.bind(b),this.foreach=this.foreach.bind(b),this.reverseChild=this.reverseChild.bind(b),this.first=this.first.bind(b),this.last=this.last.bind(b),this.contains=this.contains.bind(b),this.style=
b.style,this.hasAttribute=function(){}.bind(b),this.removeAttribute=function(d){this.removeAttribute(d)}.bind(b),this.element=b,this.setAttribute=this.setAttribute.bind(b);else{if(b&&void 0!=b.nodeType&&1==b.nodeType)return new c(b,!0);if(void 0===b)return new c(h(),!0);throw Error("[Dandelion.IDOMElement] Invalid argument");}return this}var e=L("Dandelion"),b=N("System.utils.IKey");N("System.utils.Perf");var h=e[0]("wrap"),d=e[0]("IDOMObject");q(c,d);c.prototype.setAttribute=function(d,h){if(d instanceof
b)this.setAttribute(d.keyName,d.keyValue);else if(d instanceof Array)for(var e in d)d[e]instanceof b&&this.setAttribute(d[e].keyName,d[e].keyValue);else this.setAttribute(d,h)};c.prototype.lootChildren=function(d){for(var b=d.childNodes;b.length;)this.appendChild(d.removeChild(b[0]))};c.prototype.getDAttribute=function(d){return(d=this.getAttribute("data-"+d))&&decodeURIComponent(d)};c.prototype.foreach=function(d,b){for(var h=Array.apply([],this.childNodes),e=h.length,a=0;a<e;a++)h[a].nodeType==
d&&b(h[a],this)};c.prototype.first=function(d,b){for(var h=this.childNodes,e=h.length,k=null,c=a(d),g=0;g<e;g++)if(c(h[g],d)&&(void 0===b||b(h[g],this))){k=h[g];break}return k};c.prototype.last=function(d,b){for(var h=this.childNodes,e=null,k=a(d),c=h.length-1;-1<c;c--)if(k(h[c],d)&&(void 0===b||b(h[c],this))){e=h[c];break}return e};c.prototype.contains=function(d){return d.parentElement?d==this?!0:this.contains(d.parentElement):!1};c.prototype.aKeys=function(){for(var d=[],h=this.element.attributes,
e=h.length,a=0;a<e;a++)d.push(new b(h[a].name,h[a].value));return d};c.prototype.reverseChild=function(){for(var d=this.childNodes.length-1;-1<--d;)this.appendChild(this.childNodes[d])};e[1](2,"IDOMElement",c)})();BotanJS.define("System.utils.DataKey");(function(){function a(a,c){g.call(this,"data-"+a,c?encodeURIComponent(String(c)):"")}var f=L("System.utils"),g=f[0]("IKey");q(a,g);f[1](2,"DataKey",a)})();BotanJS.define("System.utils");
(function(){var a=L("System.utils"),f=N("System.Global");a[1](3,"objGetProp",function(a,k,c){if(a&&a[k]){var e=a[k].constructor.toString().match(/function ([^\(]+)/);if(e&&2==e.length&&e[1].toUpperCase()==c.toUpperCase())return a[k]}return null});a[1](3,"objSearch",function(a,k,c){for(var e in a)if(k(a[e]))return a[e][c]||a[e];return null});a[1](3,"objMap",function(a,k){for(var c in a)a[c]=k(a[c])});a[1](3,"siteProto",function(a){return a.match(/^https?:\/\//)?f.SECURE_HTTP?a.replace(/^http:\/\//,
"https://"):a.replace(/^https:\/\//,"http://"):"http"+(f.SECURE_HTTP?"s":"")+"://"+a})})();BotanJS.define("System.Tick");
(function(){function a(){var a=0;this.M=!1;this.loop=function(){for(var k in this.steppers)this.steppers[k]();a++};r(this,"count",function(){return a})}var f=L("System");a.prototype.putStepper=function(a){var k=this.steppers.length;this.steppers[k]=a;return k};a.prototype.start=function(){this.M||(this.id=setInterval(this.loop.bind(this),0),this.M=!0)};a.prototype.stop=function(){this.M&&(this.M=!1,clearInterval(this.id))};a.prototype.steppers=[];r(a.prototype,"started",function(){return this.M});
f[1](2,"Tick",a)})();BotanJS.define("System.Log");(function(){var a=L("System.Log"),f=[];a[1](3,"writeLine",function(a,k){k=void 0===k?16:k;var c=!1,e;for(e in f)f[e](a,k),c=!0;!c&&window.console&&console.log&&console.log(a)});a[1](3,"registerHandler",function(a){var k=-1;f[k=f.length]=a;return k});a[1](3,"removeHandler",function(a){delete f[a]});a[1](0,"INFO",16);a[1](0,"ERROR",32);a[1](0,"SYSTEM",1)})();BotanJS.define("System.Debug");
(function(){function a(){k&&g.writeLine(Array.prototype.join.call(arguments," "),g.INFO)}var f=L("System.Debug"),g=N("System.Log"),k=N("System.Global").debug,c=!0;for(BotanJS.log.write=a;!BotanJS.log.end();)a(BotanJS.log.read());f[1](3,"Error",function(a){c&&g.writeLine(a.name+"\n\t"+a.message+"\n\t"+a.stack,g.ERROR)});f[1](3,"Info",a);f[1](3,"turnOff",function(a){"info"==a?k=!1:"error"==a&&(c=!1)});f[1](3,"turnOn",function(a){"info"==a?k=!0:"error"==a&&(c=!0)})})();BotanJS.define("System.Cycle");
(function(){function a(b){b.target.removeEventListener("NS_IMPORT",a);b=N("System.Cycle.TICK",!0);b!=e&&b.ob?(k.Info("[System.Cycle] Global Tick exists"),e=null):(k.Info("[System.Cycle] Creating global Tick"),e.start())}var f=L("System.Cycle");N("System.utils");var g=N("System.Tick"),k=N("System.Debug"),c=[],e=new g;e.putStepper(function(){var b=(new Date).getTime(),a;for(a in c){var d=c[a];if(d&&b>d[1]){try{d[0]()}catch(e){k.Error(e);delete c[a];continue}d[2]?delete c[a]:d[1]=b+d[4]}}});f.addEventListener("NS_IMPORT",
a);f[1](3,"next",function(b){var a=[];a[0]=b;a[1]=0;a[2]=!0;c[c.length]=a});f[1](3,"delay",function(b,a){var d=[];d[0]=b;d[1]=(new Date).getTime()+a;d[2]=!0;c[c.length]=d});f[1](3,"perma",function(b,a,d){for(var e in c)if(c[e][3]==b)return!1;e=[];e[0]=a;e[1]=(new Date).getTime()+d;e[2]=!1;e[3]=b;e[4]=d;c[c.length]=e});f[1](3,"permaRemove",function(b){for(var a in c)c[a][3]==b&&delete c[a]});f[1](10,"TICK",function(){return e})})();BotanJS.define("Components.Vim.State.Registers");
(function(){function a(){this.$={}}function f(a,c){this.na=a+"";this.newLine=Boolean(c)}var g=L("Components.Vim.State");f.prototype.newLine=!1;f.prototype.toString=function(){return this.na};f.prototype.indexOf=function(a,c){return this.na.indexOf(a,c)};r(f.prototype,"length",function(){return this.na.length});a.prototype.Na=function(a){this.$['"']=a};a.prototype.yank=function(a,c){var e=new f(a,c);this.Na(e);this.$[0]=e};a.prototype.change=function(a,c){var e=new f(a,c);this.Na(e);for(var b=this.$,
h=9;1<h;h--)void 0!=b[h-1]&&(b[h]=b[h-1]);b[1]=e};a.prototype.get=function(a){a||0===a||(a='"');return this.$[a]};g[1](2,"Registers",a)})();BotanJS.define("Components.Vim.Syntax.Word");
(function(){function a(a){a:{a=a.charCodeAt(0);for(var e=0;e<k;e++)for(var b=g[e],h=b.length,d=0;d<h;d++){var m=b[d];if(m[0]<=a&&a<=m[1]){a=b;break a}}a=[]}this.jb=a}var f=L("Components.Vim.Syntax"),g=[[[48,57]],[[65,90],[97,122],[192,255],[256,383],[384,591],[7424,7551],[7552,7615],[7616,7679],[7680,7935],[7936,8191]],[[592,687],[688,767],[768,879],[880,1023],[1024,1279],[1280,1327],[1328,1423]],[[1424,1535],[1536,1791],[1792,1871],[1872,1919],[1920,1983],[1984,2047],[2048,2111],[2112,2143],[2208,
2303]],[[2304,2431],[2432,2559],[2560,2687],[2688,2815],[2816,2943],[2944,3071],[3072,3199],[3200,3327],[3328,3455],[3456,3583],[3584,3711],[3712,3839],[3840,4095],[4096,4255],[4256,4351],[4352,4607],[4608,4991],[4992,5023],[5024,5119],[5120,5759],[5760,5791],[5792,5887]],[[5888,5919],[5920,5951],[5952,5983],[5984,6015],[6016,6143],[6144,6319],[6320,6399],[6400,6479]],[[6480,6527],[6528,6623],[6624,6655],[6656,6687],[6688,6831],[6832,6911],[6912,7039],[7040,7103],[7104,7167],[7168,7247],[7248,7295],
[7360,7375],[7376,7423]],[[8192,8303],[8304,8351],[8352,8399],[8400,8447],[8448,8527],[8528,8591],[8592,8703],[8704,8959],[8960,9215],[9216,9279],[9280,9311],[9312,9471],[9472,9599],[9600,9631],[9632,9727],[9728,9983],[9984,10175],[10176,10223],[10224,10239],[10240,10495],[10496,10623],[10624,10751],[10752,11007],[11008,11263],[11264,11359],[11360,11391],[11392,11519],[11520,11567],[11568,11647],[11648,11743],[11744,11775],[11776,11903]],[[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12352,
12447],[12448,12543],[12544,12591],[12592,12687],[12688,12703],[12704,12735],[12736,12783],[12784,12799],[12800,13055],[13056,13311],[13312,19903],[19904,19967],[19968,40959],[40960,42127],[42128,42191],[42192,42239],[42240,42559],[42560,42655],[42656,42751],[42752,42783],[42784,43007],[43008,43055],[43056,43071],[43072,43135],[43136,43231],[43232,43263],[43264,43311],[43312,43359],[43360,43391],[43392,43487],[43488,43519],[43520,43615],[43616,43647],[43648,43743],[43744,43775],[43776,43823],[43824,
43887],[43888,43967],[43968,44031],[44032,55215],[55216,55295]],[[55296,56319],[56320,57343],[57344,63743],[63744,64255],[64256,64335],[64336,65023],[65024,65039],[65040,65055],[65056,65071],[65072,65103],[65104,65135],[65136,65279],[65280,65519],[65520,65535]],[[33,47],[58,64],[91,96],[123,126],[161,172],[174,191]],[[32,32],[9,9]]],k=g.length;a.prototype.test=function(a){if(void 0==a||null==a||!a.charCodeAt)return!1;var e=this.jb,b=e.length;a=a.charCodeAt(0);for(var h=0;h<b;h++){var d=e[h];if(d[0]<=
a&&a<=d[1])return!0}return!1};f[1](2,"Word",a)})();BotanJS.define("Components.Vim.Syntax.Analyzer");
(function(){function a(){this.Aa=this.Ka=this.S=this.Z=-1;this.Ea=null}function f(b){this.T=b;this.ca={}}function g(b,d){if(!d)throw Error("Parent not found");var e=new a;e.Aa=d[2];e.Z=d[0];e.S=d[1];if(-1<d[3]){var p=b.find(d[3]);e.Ea=g(b,p)}return e}function k(b,d){for(var a=d.length,p=b.split("\n"),n=p[0],p=p[1],k=[],c=[],g=0,f=[],v=n.length,z=p.length,x=0;x<a;x++){var B=d.substr(x,z);if(d.substr(x,v)==n)k[g]=x,g++,x+=v-1;else if(B==p){B=x;if(0==g)c.push(B);else{var A=[];A[0]=k[--g];A[1]=B;A[2]=
g;A[3]=0<g?k[g-1]:-1;f.push(A)}x+=z-1}}c.length&&e.Info('Unmatched opening "'+n+'"@'+c.join(", "));0<g&&e.Info('Unmatched closing "'+p+'"@'+k.slice(0,g));this.Ca=f}var c=L("Components.Vim.Syntax"),e=N("System.Debug"),b=c[0]("Word");k.prototype.find=function(b,d){void 0==d&&(d=0);for(var a=this.Ca,e=a.length,n=0;n<e;n++){var k=a[n];if(k[d]==b)return k}return null};f.prototype.bracketAt=function(b){var d=this.T.content,e=1,p=null,n=d[b];switch(n){case "{":e=0;case "}":p=this.H("{\n}");break;case "[":e=
0;case "]":p=this.H("[\n]");break;case "(":e=0;case ")":p=this.H("(\n)");break;case "/":if("*"==d[b-1]){n="*/";b--;break}else if("*"==d[b+1]){n="/*";break}return new a;case "*":if("/"==d[b-1]){n="/*";b--;break}else if("/"==d[b+1]){n="*/";break}return new a;default:return new a}if(!p)switch(n){case "/*":e=0;case "*/":p=this.H("/*\n*/");break;default:return new a}d=p.find(b,e);p=g(p,d);p.Ka=b;return p};f.prototype.bracketIn=function(b,d){var e="{[(".indexOf(b);0>e&&(e="}])".indexOf(b));if(0>e)throw Error("Unsupported bracket: "+
b);for(var p=this.H("{[("[e]+"\n"+"}])"[e]),n=p.Ca,k=n.length,c=null,e=0;e<k;e++){var f=n[e];f[0]<=d&&d<=f[1]&&(c&&c[2]<f[2]||!c)&&(c=f)}if(c){p=e=g(p,c);do p.Z++,p.S--;while(p=p.parent);return e}return new a};f.prototype.H=function(b){if(this.ca[b])return this.ca[b];var d=new k(b,this.T.content);return this.ca[b]=d};f.prototype.reset=function(){this.ca={}};f.prototype.quoteAt=function(b){switch(this.T.content[b]){default:return{level:0,open:-1,close:-1}}};f.prototype.wordAt=function(e){var d=this.T.content,
m=d.length,p=e,n=e,k=new b(d[e]);if(0<e)for(;k.test(d[--p]););if(e<m)for(;k.test(d[++n]););e=new a;e.Z=0<p?p+1:0;e.S=n-1;return e};r(a.prototype,"parent",function(){return this.Ea});r(a.prototype,"open",function(){return this.Z});r(a.prototype,"close",function(){return this.S});r(a.prototype,"level",function(){return this.Aa});r(a.prototype,"selected",function(){return this.Ka});c[1](2,"Analyzer",f);c[1](2,"TokenMatch",a)})();BotanJS.define("Components.Vim.LineBuffer");
(function(){function a(a,c){this.prev=null;this.cols=a;this.next=c;this.br=!1;this.placeholder=!0;this.lineNum=0;this.tabWidth=8;c&&(c.prev=this)}var f=L("Components.Vim");N("System.Debug");var g=N("System.utils.Perf.CountSubstr");a.prototype.P=function(a,c,e){this.lineNum=e;if(void 0==a||""===a)this.lineNum=++e,this.content="~",this.placeholder=this.br=!0,this.next&&this.next.P(a,c,e+1);else{this.placeholder=!1;var b="",h=!1,d=0,m=0,p=this.tabWidth-1;if(c){for(;d<this.cols-m*p;d++){var n=a[d];if(void 0===
n)break;if("\n"==n){h=!0;d++;break}else"\t"==n&&m++;b+=n}h||d!=this.cols||"\n"!=a[d]||(d++,h=!0)}else for(h=!0;;d++){n=a[d];if(void 0===n)break;if("\n"==n){d++;break}else"\t"==n&&m++;d<this.cols-m*p&&(b+=n)}this.next&&(this.next.br=h,this.next.P(a.substr(d),c,h?e+1:e));this.content=b}};a.prototype.toString=function(){var a=this.cols-g(this.content,"\t")*(this.tabWidth-1);return this.content.length<a?this.content+" ":this.content||" "};r(a.prototype,"nextLine",function(){for(var a=this,c=this.lineNum;(a=
a.next)&&a.lineNum==c;);return a});r(a.prototype,"visualLines",function(){for(var a=[this],c=this;(c=c.next)&&!c.br;)a.push(c);return a});f[1](2,"LineBuffer",a)})();BotanJS.define("Components.Vim.State.Recorder");
(function(){function a(){this.N=[];this.Za=[];this.Ja=this.ya=this.d=0}var f=L("Components.Vim.State");a.prototype.undo=function(){var a=this.d-1;return-1!=a&&this.N.length?this.N[this.d=a]:null};a.prototype.redo=function(){var a=this.N[this.d];return a?(this.d++,a):null};a.prototype.save=function(){this.Ja=this.d};a.prototype.record=function(a){this.N[this.d++]=a;this.Za[this.ya++]=a;delete this.N[this.d];a.id=this.ya};r(a.prototype,"changed",function(){return this.Ja!=this.d});f[1](2,"Recorder",
a)})();BotanJS.define("Components.Vim");VIMRE_VERSION="1.0.0b";
(function(){function a(a,b,h){if(void 0==a[b])return b;var d=0;return a[b].replace(/%\d+/g,function(){return h[d++]})}var f=L("Components.Vim"),g={INSERT:"-- INSERT --",REPLACE:"-- REPLACE --",MORE:"-- MORE --",VISUAL:"-- VISUAL  --",VISLINE:"-- VISUAL LINE --",REGISTERS:"--- Registers ---",WRITE:'"%1" %2L, %3C written',WAIT_FOR_INPUT:"Press ENTER or type command to continue",SEARCH_HIT_BOTTOM:"Seach hit BOTTOM, contining at TOP",TOP:"Top",BOTTOM:"Bot",ALL:"All",EXIT:"Type :quit<Enter>  to exit Vim",
UNDO_LIMIT:"Already at oldest change",REDO_LIMIT:"Already at newest change",LINES_FEWER:"%1 fewer line(s)",LINES_MORE:"%1 more line(s)",LINES_YANKED:"%1 line(s) yanked",SEARCH_HIT_BOTTOM:"search hit BOTTOM, continuing at TOP",SEARCH_HIT_TOP:"search hit TOP, continuing at BOTTOM",REPLACE:"%1 substitution(s) on %2 line(s)"},k={E35:"No previous regular expression",E37:"No write since last change (add ! to override)",E481:"No range allowed",E492:"Not an editor command: %1",E486:"Pattern not found: %1",
EX1:"Pattern Error( %1 )",EX2:"This pattern is causing infinite loop: %1",TODO:"%1 is not implemented yet",MISSING_FEATURE:'Sorry, I thought this command wasn\'t useful enough to implement. Please file a feature request titled "Implement %1" in github if you think this is important.'},c=new Audio("data:audio/ogg;base64,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");
f[1](3,"Message",function(e){return a(g,e,Array.prototype.slice.call(arguments,1))});f[1](3,"Error",function(e){return e+": "+a(k,e,Array.prototype.slice.call(arguments,1))});f[1](3,"Beep",function(){setTimeout(function(){c.pause();c.currentTime=0;c.play()},0)})})();BotanJS.define("Components.Vim.Actions.WRITE");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var f=L("Components.Vim.Actions");N("System.Debug");var g=N("Components.Vim.Message"),k=N("System.utils.Perf.CountSubstr");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();var e=this.a;a=e.Vim;a.content=e.feeder.content.slice(0,-1);a=g("WRITE",a.stage.element.id,k(a.content,"\n"),a.content.length);e.rec.save();for(var e=this.a.feeder.firstBuffer.cols,b=a.length;b<e;b++)a+=" ";
this.b=a};a.prototype.getMessage=function(){return this.b};f[1](2,"WRITE",a)})();BotanJS.define("Components.Vim.DateTime.String");
(function(){function a(a,k,c){if(void 0==a[k])return k;var e=0;return a[k].replace(/%\d+/g,function(){return c[e++]})}var f={AboutAMinuteAgo:"about a minute ago",AboutAMonthAgo:"about a month ago",AboutAnHourAgo:"about an hour ago",AboutAWeekAgo:"about a week ago","last Friday":"last Friday","last Monday":"last Monday","last Saturday":"last Saturday","last Sunday":"last Sunday","last Thursday":"last Thursday","last Tuesday":"last Tuesday","last Wednesday":"last Wednesday","on Friday":"on Friday",
"on Monday":"on Monday","on Saturday":"on Saturday","on Sunday":"on Sunday","on Thursday":"on Thursday","on Tuesday":"on Tuesday","on Wednesday":"on Wednesday",OverAYearAgo:"over a year ago",XHoursAgo_2To4:"%1 hours ago",XHoursAgo_EndsIn1Not11:"%1 hours ago",XHoursAgo_EndsIn2To4Not12To14:"%1 hours ago",XHoursAgo_Other:"%1 hours ago",XMinutesAgo_2To4:"%1 minutes ago",XMinutesAgo_EndsIn1Not11:"%1 minutes ago",XMinutesAgo_EndsIn2To4Not12To14:"%1 minutes ago",XMinutesAgo_Other:"%1 minutes ago",XMonthsAgo_2To4:"%1 months ago",
XMonthsAgo_5To12:"%1 months ago",XSecondsAgo_2To4:"%1 seconds ago",XSecondsAgo_EndsIn1Not11:"%1 seconds ago",XSecondsAgo_EndsIn2To4Not12To14:"%1 seconds ago",XSecondsAgo_Other:"%1 seconds ago",XWeeksAgo_2To4:"%1 weeks ago"};L("Components.Vim.DateTime")[1](3,"String",function(g){return a(f,g,Array.prototype.slice.call(arguments,1))})})();BotanJS.define("Components.Vim.DateTime");
(function(){function a(a,e){var d=a%10,m=a%100;if(1>=a)throw Error("Invalid number of Time units");return 2<=a&&4>=a?g(e[0],a):1==d&&11!=m?g(e[1],a):2<=d&&4>=d&&!(12<=m&&14>=m)?g(e[2],a):g(e[3],a)}var f=L("Components.Vim.DateTime"),g=f[0]("String"),k=["XHoursAgo_2To4","XHoursAgo_EndsIn1Not11","XHoursAgo_EndsIn2To4Not12To14","XHoursAgo_Other"],c=["XMinutesAgo_2To4","XMinutesAgo_EndsIn1Not11","XMinutesAgo_EndsIn2To4Not12To14","XMinutesAgo_Other"],e=["XSecondsAgo_2To4","XSecondsAgo_EndsIn1Not11","XSecondsAgo_EndsIn2To4Not12To14",
"XSecondsAgo_Other"];f[1](3,"RelativeTime",function(b){var h=Math.round(.001*((new Date).getTime()-b.getTime()));if(31536E3<h)result=g("OverAYearAgo");else if(3952800<h)if(b=Math.round((h+1317600)/2635200),2<=b&&4>=b)result=g("XMonthsAgo_2To4",b);else if(5<=b&&12>=b)result=g("XMonthsAgo_5To12",b);else throw Error("Invalid number of Months");else if(2116800<=h)result=g("AboutAMonthAgo");else if(604800<=h)b=Math.round(h/604800),result=1<b?g("XWeeksAgo_2To4",b):g("AboutAWeekAgo");else{if(432E3<=h)switch(b.getDay()){case 1:b=
g("last Monday");break;case 2:b=g("last Tuesday");break;case 3:b=g("last Wednesday");break;case 4:b=g("last Thursday");break;case 5:b=g("last Friday");break;case 6:b=g("last Saturday");break;case 0:b=g("last Sunday");break;default:b=g("last Sunday")}else if(86400<=h)switch(b.getDay()){case 1:b=g("on Monday");break;case 2:b=g("on Tuesday");break;case 3:b=g("on Wednesday");break;case 4:b=g("on Thursday");break;case 5:b=g("on Friday");break;case 6:b=g("on Saturday");break;case 0:b=g("on Sunday");break;
default:b=g("on Sunday")}else b=7200<=h?a(Math.round(h/3600),k):3600<=h?g("AboutAnHourAgo"):120<=h?a(Math.round(h/60),c):60<=h?g("AboutAMinuteAgo"):a(1<h?h:2,e);result=b}return result})})();BotanJS.define("Components.Vim.State.Stack");
(function(){function a(){}var f=L("Components.Vim.State"),g=N("Components.Vim.DateTime.RelativeTime");a.prototype.store=function(a){this.xa=a;this.fb=new Date;this.id=0};a.prototype.play=function(){this.xa&&this.xa()};r(a.prototype,"time",function(){return g(this.fb)});f[1](2,"Stack",a)})();BotanJS.define("Components.Vim.Actions.FIND");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}function f(a){for(var e="",d=a.length,m=1;m<d;m++)switch(a[m]){case "^I":e+="\t";break;case "\\":var p=a[++m];if(-1!="nrts.[]()^".indexOf(p))e+="\\"+p;else throw Error('Missing token impl: "'+p+'"');break;default:e+=a[m]}return new RegExp("("+e+")","gm")}var g=L("Components.Vim.Actions");N("System.Debug");var k=N("Components.Vim.Error"),c=N("Components.Vim.Message"),e=[];a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=
function(a,h){a.preventDefault();if(h){if(2>h.length){if(1>e.length)return this.b=k("E35"),!0;h=e}e=h}if(1>e.length)return this.b=k("E35"),!0;var d;try{d=f(e)}catch(m){return this.b=k("EX1",m.message),!0}var p=this.a.feeder.content,n=this.a;h=n.aPos;for(var g,s,w,t=[],v;null!==(g=d.exec(p));){void 0==w&&(w=g.index);if(v==g.index)return this.b=k("EX2",e.slice(1).join("")),!0;if(h<g.index){s=g.index;break}t.push(g.index);v=g.index}if(a.kMap("N")){if(s=t[t.length-2],void 0==s)for(this.b=c("SEARCH_HIT_TOP");null!==
(g=d.exec(p));)s=g.index}else void 0!=w&&void 0==s?(s=w,this.b=c("SEARCH_HIT_BOTTOM")):this.b=e.join("");void 0==s?this.b=k("E486",e.slice(1).join("")):n.moveTo(s)};a.prototype.getMessage=function(){return this.b};y(a,"Pattern",f);g[1](2,"FIND",a)})();BotanJS.define("Components.Vim.Actions.REPLACE");
(function(){function a(a){this.a=a;this.B=this.b="";this.Ga=0;this.ka=this.ka.bind(this);this.ia=0;this.la=[];a.suppressEvent()}function f(a){for(var d="",b=a.length,e=[""],n=1;n<b;n++)switch(a[n]){case "^I":d+="\t";break;case "\\":n++;var c=a[n];if(-1!="$nrt\\".indexOf(c)){d+=JSON.parse('"\\'+c+'"');break}if(-1!="012345678".indexOf(c))e.push(d.length),d+=c;else{if("9"==c)throw Error("Back ref 9 is reserved for back ref 0");throw Error('Missing token impl: "'+tok+'"');}break;default:d+=a[n]}e[0]=
d;return e}var g=L("Components.Vim.Actions"),k=N("System.Debug"),c=N("Components.Vim.State.Stack"),e=N("Components.Vim.Error");N("Components.Vim.Message");N("System.utils.Perf.CountSubstr");var b=g[0]("FIND");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,d){a.preventDefault();var m,p;try{var n=d.indexOf("/",0),c=d.indexOf("/",n+1);if(-1==n)return this.b=e("MISSING_FEATURE","REPLACE %s"),!0;if(-1==c)m=b.Pattern(d),p=d;else{p=d.slice(n,c);m=b.Pattern(p);var g=
d.indexOf("/",c+1);this.B=-1==g?f(d.slice(c)):f(d.slice(c,g));this.Ga=this.B[0].length}}catch(w){return this.b=e("EX1",w.message),!0}k.Info("Replace: "+m+", [ "+this.B+" ]");n=this.a.feeder;m=n.content.slice(0,-1).replace(m,this.ka)+"\n";this.la.length||(this.b=e("E486",p.join("")));n.content=m;this.A();n.pan();n.softReset();return!0};a.prototype.ka=function(){for(var a=arguments[0],d=Array.prototype.slice.call(arguments,1,-2),b=this.ia+arguments[arguments.length-2],e="",n=this.B[0],c=0;c<this.Ga;c++)var k=
this.B.indexOf(c,1),e=-1==k?e+n[c]:e+d[n[this.B[k]]];d=e.length;this.ia+=d-a.length;n=[];n[0]=a;n[1]=b;n[2]=d;this.la.push(n);return e};a.prototype.A=function(){var a=new c,d=this.la,b=d.length,e=this.a,n=e.feeder;a.store(function(){for(var a=n.content,h="",c=0,k=-1,g=0;g<b;g++){var f=d[g],x=f[1],B=f[2],A=f[0],M=A.length,h=h+(a.substring(c,x)+A),c=f[1]+B;f[0]=a.substr(x,B);f[1]=h.length-M;f[2]=M;-1==k&&(k=x)}h+=a.substring(c);n.content=h;e.moveTo(k);n.pan()});e.rec.record(a)};a.prototype.getMessage=
function(){return this.b};g[1](2,"REPLACE",a)})();BotanJS.define("Components.Vim.Actions.YANK");
(function(){function a(a){this.a=a;this.k=a.aPos;this.b="";a.suppressEvent()}var f=L("Components.Vim.Actions");N("System.Debug");var g=N("Components.Vim.Message"),k=N("Components.Vim.Beep"),c=N("System.utils.Perf.CountSubstr");a.prototype.allowMovement=!0;a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,b,h){a.preventDefault();if(!a.ModKeys&&!a.kMap("i")){var d=a.target.ea,m=this.a,p=!1;if(void 0==b){p=!0;b=this.k;var n=m.aPos;if(this.k!=n)a.kMap("^")?b--:a.kMap("l")?
m.moveX(-1):a.kMap("h")?b=n:a.kMap("j")?(h=!0,m.lineEnd(!0),b=m.aPos,m.moveY(-1),m.lineStart(),this.k=m.aPos):a.kMap("k")?(h=!0,m.moveY(1),m.lineEnd(!0),b=m.aPos,m.moveY(-1),m.lineStart()):this.k<n&&(b=n,m.moveTo(this.k));else if(a.kMap("y"))h=!0,m.lineEnd(!0),b=m.aPos,m.lineStart();else if(a.range)b=a.range.close,m.moveTo(a.range.open,!0);else{if(a.kMap("^"))return!0;if(a.kMap("$"))b=m.aPos;else return k(),!0}}n=b;a=m.aPos;a<n&&(n=m.aPos,a=b);m.moveTo(n);a=m.feeder.content.substring(n,a+1);d.yank(a,
h);if(h=c(a,"\n"))this.b=g("LINES_YANKED",h);return p}};a.prototype.getMessage=function(){return this.b};f[1](2,"YANK",a)})();BotanJS.define("Components.Vim.State.Stator");
(function(){function a(a,k){this.a=a;this.$a=void 0==k?a.aPos:k;this.ab=this.Ia()}var f=L("Components.Vim.State");a.prototype.save=function(a,k,c){void 0==c&&(c=0);var e=this.a,b=e.feeder,h=this.$a-c,d=this.ab,m=this.Ia(),p=d;return function(){var c=b.content.substr(h,a);b.content=b.content.substring(0,h)+k+b.content.substring(h+a);a=k.length;k=c;e.PStart=p.c;e.PEnd=p.c+1;e.X=p.x;e.Y=p.y;e.pX=p.ib-1;b.panX=p.lb;b.panY=p.mb;b.pan();p=p==d?m:d}};a.prototype.Ia=function(){var a=this.a,a={c:a.PStart,
x:a.X,y:a.Y,ib:a.pX,lb:a.feeder.panX,mb:a.feeder.panY};0<a.x&&(--a.c,--a.x);return a};f[1](2,"Stator",a)})();BotanJS.define("Components.Vim.Actions.DELETE");
(function(){function a(a){this.a=a;this.ha=0;this.k=a.aPos;this.Da=this.a.feeder.panY;a.suppressEvent()}var f=L("Components.Vim.Actions"),g=N("System.Debug"),k=N("Components.Vim.State.Stator"),c=N("Components.Vim.State.Stack"),e=N("Components.Vim.Message"),b=N("Components.Vim.Beep"),h=N("System.utils.Perf.CountSubstr");a.prototype.allowMovement=!0;a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,e,p){a.preventDefault();if(!a.ModKeys){var n=a.target.ea,f=this.a,
s=f.feeder;if(s.firstBuffer.next.placeholder&&2>s.content.length)return g.Info("Content is empty"),!0;var w=!1;if(void 0==e){w=!0;e=this.k;var t=f.aPos;if(this.k!=t)a.kMap("^")?e--:a.kMap("l")?f.moveX(-1):a.kMap("h")?e=t:a.kMap("j")?(p=!0,f.lineEnd(!0),e=f.aPos,f.moveY(-1),f.lineStart(),this.k=f.aPos):a.kMap("k")?(p=!0,f.moveY(1),f.lineEnd(!0),e=f.aPos,f.moveY(-1),f.lineStart()):this.k<t&&(e=t,f.moveTo(this.k));else if(a.kMap("d"))p=!0,f.lineEnd(!0),e=f.aPos,f.lineStart();else if(a.range)e=a.range.close,
f.moveTo(a.range.open,!0);else{if(a.kMap("^"))return!0;if(a.kMap("$"))e=f.aPos;else return b(),!0}}var t=s.content.slice(0,-1),v=e;a=f.aPos;a<v&&(v=f.aPos,a=e);e=t.substring(v,a+1);n.change(e,p);this.ha=h(e,"\n");s.content=t.substring(0,v)+t.substring(a+1)+"\n";s.pan(void 0,this.Da<s.panY?this.Da-s.panY:void 0);f.moveTo(v);a=new k(f,v);p=new c;var z=a.save(0,e);p.store(function(){z();f.moveX(1)});f.rec.record(p);return w}};a.prototype.getMessage=function(){return this.ha?e("LINES_FEWER",this.ha):
""};f[1](2,"DELETE",a)})();BotanJS.define("Components.Vim.Actions.VISUAL");
(function(){function a(a){this.Ha(a);this.b="";a.blink=!1;a.pSpace=!0}function f(a,b){if(0==b)return 0;for(var e=a.feeder,c=0,n=-1,k=e.content.indexOf("\n");0<=k&&!(n=k,c++,b<=c);k=e.content.indexOf("\n",k+1));e.EOF&&(k=n);e=e.content[k+1];void 0!=e&&"\n"!=e&&k++;return k}var g=L("Components.Vim.Actions"),k=N("System.Debug"),c=N("Components.Vim.Message"),e=g[0]("YANK"),b=g[0]("DELETE");a.prototype.Ha=function(a){this.a=a;var b={lineNum:a.e().lineNum,X:a.X,aPos:a.aPos,kb:a.PStart};b.hb=b.aPos-a.aX;
a.suppressEvent();a.lineEnd(!0);b.gb=a.aPos;a.moveTo(b.aPos);a.unsuppressEvent();this.La=b};a.prototype.allowMovement=!0;a.prototype.dispose=function(){var a=this.a;a.blink=!0;a.pSpace=!1;a.updatePosition();a.feeder.wrap&&0<a.X&&(a.suppressEvent(),a.moveX(-1),a.moveX(1),a.unsuppressEvent())};a.prototype.handler=function(a){a.preventDefault();if(!a.ModKeys){var d=this.a,m=d.feeder,p=null,n=!1;if(a.kMap("y"))p=new e(d);else if(a.kMap("d"))p=new b(d);else if(a.kMap("V")){if(1==this.n)return!0;n=!0;this.n=
1;this.b=c("VISLINE")}else if(a.kMap("v")){if(0==this.n)return!0;n=!0;this.n=0;this.b=c("VISUAL");d.updatePosition()}n&&m.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"));if(-1==this.n)return k.Error(Error("Mode is undefined")),!0;n=this.La;if(p){d.suppressEvent();if(m=1==this.n)n.aPos<d.aPos?(d.lineEnd(!0),n.aPos=n.hb):(d.lineStart(),n.aPos=n.gb);if(p.constructor==b&&n.aPos<d.aPos){var g=d.aPos;d.moveTo(n.aPos,!0);n.aPos=g}p.handler(a,n.aPos,m);p.constructor!=b&&d.moveTo(n.aPos);this.b=p.getMessage();
p.dispose();d.unsuppressEvent();n.kb=d.PStart;return!0}a.range&&(d.suppressEvent(),a=a.range,d.aPos==n.aPos&&(d.moveTo(a.open,!0),this.Ha(d),n=this.La),d.unsuppressEvent(),d.moveTo(a.close,!0));var s=d.aPos,p=m.firstBuffer;a=p.lineNum;var w=f(d,a),t=f(d,a+m.moreAt+1)-1;k.Info("Min aPos: "+w,"Max aPos: "+t);a=n.X;g=d.PStart;if(n.aPos<w)a=0,1==this.n&&(d.suppressEvent(),d.lineEnd(!0),g=d.PStart,d.moveTo(s,!0),d.unsuppressEvent());else if(t<n.aPos){a=-2;n=0;do{if(p.placeholder)break;n<=m.moreAt&&(a+=
p.toString().length+1);n++}while(p=p.next)}else{m=n.lineNum;if(1==this.n)d.suppressEvent(),a=0,s<n.aPos?(a=-1,m++,d.lineStart(),g=d.PStart):n.aPos<s?(d.lineEnd(!0),g=d.PStart):(d.lineStart(),g=d.PStart,d.lineEnd(!0),a=d.PStart,m=p.lineNum),d.moveTo(s,!0),d.unsuppressEvent();else if(0==this.n&&s==n.aPos)return;do{if(p.lineNum==m||p.placeholder)break;a+=p.toString().length+1}while(p=p.next)}n=a;m=g;p=m-n;0<=p?m+=1:0>p&&(n+=p,m=a+1);d.PStart=n;d.PEnd=m}};a.prototype.getMessage=function(){return this.b};
g[1](2,"VISUAL",a)})();BotanJS.define("Components.Vim.Actions.JOIN_LINES");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var f=L("Components.Vim.Actions");N("System.Debug");var g=N("Components.Vim.State.Stator"),k=N("Components.Vim.State.Stack"),c=N("Components.Vim.Beep");N("Components.Vim.Message");N("System.utils.Perf.CountSubstr");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,b){a.preventDefault();var h=this.a,d=h.feeder,m,p,n,f;if(b)m=b.start;else{f=h.aPos;h.lineEnd(!0);n=new g(h);m=h.aPos;h.moveY(1);h.lineStart();
p=h.aPos;if(p<m)return h.moveTo(f),c(),!0;var s=d.content;f=d.content.substring(m,p);d.content=s.substring(0,m)+" "+s.substr(p)}d.pan();h.moveTo(m);d=new k;d.store(n.save(1,f));h.rec.record(d)};a.prototype.getMessage=function(){return this.b};f[1](2,"JOIN_LINES",a)})();BotanJS.define("Components.Vim.Actions.EDITOR_COMMAND");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var f=L("Components.Vim.Actions"),g=N("System.Debug"),k=N("Components.Vim.Error");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,e){a.preventDefault();var b=1,h="",d=[];if(-1!=".$%".indexOf(e[b]))h=e[b++];else for(;-1!="0123456789".indexOf(e[b]);b++)h+=e[b];var m="";if(-1!="/?".indexOf(e[b]))m=e[b];else for(var p=/\w/g,n=e[b];n=e[b];b++)if(n.match(p))m+=n;else break;p=!1;switch(m){case "s":case "su":case "substitute":p=
!0;d[1]="REPLACE";break;case "/":p=!0;d[1]="FIND";break;case "buffers":case "ls":d[1]="BUFFERS";break;case "w":case "write":d[1]="WRITE";break;case "q":case "quit":d[1]="QUIT";break;case "register":case "registers":d[1]="REGISTERS";break;case "ver":case "version":d[1]="VERSION";break;case "h":case "help":d[1]="HELP"}""!==h&&(p?d[0]=h:d[3]=k("E481"));d[2]=e.slice(b);if(d[3])return this.b=d[3],!0;if(!d[1])return this.b=k("E492",e.slice(1).join("")),!0;try{f[0](d[1])}catch(E){return this.b=k("TODO",
d[1]),!0}try{this.a.openRunAction(d[1],a,d[2],d[0]),this.b=this.a.message}catch(s){g.Error(s)}return!0};a.prototype.getMessage=function(){return this.b};f[1](2,"EDITOR_COMMAND",a)})();BotanJS.define("Components.Vim.Actions.TO");
(function(){function a(a){this.a=a;this.b="<TO COMMAND>";a.suppressEvent()}var f=L("Components.Vim.Actions");N("System.Debug");var g=N("Components.Vim.Beep");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,c){c.preventDefault();var e=this.a,b=e.feeder,h=e.e().lineNum,d=0;for(i=0;-1!=d&&i<h;i++)d=b.content.indexOf("\n",d+1);var m=b.content.indexOf("\n",d+1);0<h&&d++;h=d;d=c.key;c.kMap("Tab")&&(d="\t");if(1<d.length)g();else{var p=-1,p=a.kMap("t")||a.kMap("f")?
b.content.indexOf(d,e.aPos+1):b.content.lastIndexOf(d,e.aPos-1);h<=p&&p<m?e.moveTo(p):g()}};a.prototype.getMessage=function(){return this.b};f[1](2,"TO",a)})();BotanJS.define("Components.Vim.Actions.QUIT");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var f=L("Components.Vim.Actions");N("System.Debug");var g=N("Components.Vim.Error");N("System.utils.Perf.CountSubstr");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();a=this.a;var c=a.Vim;if(a.rec.changed){a=g("E37");for(var c=this.a.feeder.firstBuffer.cols,e=a.length;e<c;e++)a+=" ";this.b=a}else return c.dispose(),!0};a.prototype.getMessage=function(){return this.b};f[1](2,"QUIT",
a)})();BotanJS.define("Components.Vim.Actions.BUFFERS");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var f=L("Components.Vim.Actions");N("System.Debug");var g=N("Dandelion"),k=N("Components.Vim.Message");N("System.utils.Perf.CountSubstr");var c=N;a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();g.tag("textarea");var b=this.a.Vim,h=c("Components.Vim.VimArea").Instances;a=":buffers";for(var d in h){var m=h[d],p=m.index+" ",n=m.contentFeeder.cursor,p=p+((m==b?"%a":"  ")+" "),p=p+
((n.rec.changed?"+":" ")+" "),p=p+('"'+m.stage.element.id+'" line '+(n.e().lineNum+1));a+="\n  "+p}b=k("WAIT_FOR_INPUT");h=this.a.feeder.firstBuffer.cols;for(d=a.length;d<h;d++)a+=" ";this.b=a+"\n"+b};a.prototype.getMessage=function(){return this.b};f[1](2,"BUFFERS",a)})();BotanJS.define("Components.Vim.Actions.UNDO");
(function(){function a(a){this.a=a;this.t="UNDO COMMAND"}var f=L("Components.Vim.Actions"),g=N("Components.Vim.Message");a.prototype.dispose=function(){};a.prototype.handler=function(a){a.preventDefault();(a=this.a.rec.undo())?(a.play(),this.t="<<TODO>>; before #"+a.id+"  "+a.time):this.t=g("UNDO_LIMIT")};a.prototype.getMessage=function(){return this.t};f[1](2,"UNDO",a)})();BotanJS.define("Components.Vim.Actions.REGISTERS");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var f=L("Components.Vim.Actions");N("System.Debug");N("Components.Vim.Error");var g=N("Components.Vim.Message");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();var c=a.target.ea;a=":register\n"+g("REGISTERS");for(var e=0,b='"0123456789-.:%/='[e];void 0!=b;e++,b='"0123456789-.:%/='[e]){var h=c.get(b);h&&(a+='\n"'+b+"   "+h.toString().replace("\t","^I").replace("\n","^J"))}c=g("WAIT_FOR_INPUT");
b=this.a.feeder.firstBuffer.cols;for(e=a.length;e<b;e++)a+=" ";this.b=a+"\n"+c};a.prototype.getMessage=function(){return this.b};f[1](2,"REGISTERS",a)})();BotanJS.define("Components.Vim.Actions.PRINT_HEX");
(function(){function a(a){this.a=a}var f=L("Components.Vim.Actions");N("System.Debug");a.prototype.dispose=function(){};a.prototype.handler=function(a){a.preventDefault();a=unescape(encodeURIComponent(this.a.feeder.content[this.a.aPos]));for(var f=a.length,c=[],e=0;e<f;e++)c[e]="\n"==a[e]?"a":a.charCodeAt(e).toString(16),1==c[e].length?c[e]="0"+c[e]:0==c[e].length&&(c[e]="00");this.b=c.join(" ")};a.prototype.getMessage=function(){return this.b};f[1](2,"PRINT_HEX",a)})();BotanJS.define("Components.Vim.Actions.WORD");
(function(){function a(a){this.a=a;this.b="<WORD COMMAND>";a.suppressEvent()}var f=L("Components.Vim.Actions");N("System.Debug");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();var f=this.a,c=f.feeder,e=f.Vim.contentAnalyzer,b=f.aPos,h=1;if(a.kMap("w")||a.kMap("W")){"\n"==c.content[b+1]&&b++;var d=e.wordAt(b);-1!=d.open&&(b=d.close+1)}if(a.kMap("b")||a.kMap("B")){if(0==b)return;h=-1;d=e.wordAt(b-1);-1!=d.open&&(b=d.open)}for(;-1!=" \t".indexOf(c.content[b]);)b+=
h;f.moveTo(b)};a.prototype.getMessage=function(){return this.b};f[1](2,"WORD",a)})();BotanJS.define("Components.Vim.Actions.VERSION");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var f=L("Components.Vim.Actions");N("System.Debug");N("Components.Vim.Error");var g=N("Components.Vim.Message");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();a=":version\nVim;Re - Vim; Reverse Engineered for textarea v"+VIMRE_VERSION;a+="\n  + BotanJS - v1.0.0b\nProject home - https://github.com/tgckpg/BotanJS-vim";a+="\n  by \u659f\u914c\u9d6c\u5144 (penguin) - https://blog.astropenguin.net/";
a+="\n";for(var c=g("WAIT_FOR_INPUT"),e=this.a.feeder.firstBuffer.cols,b=a.length;b<e;b++)a+=" ";this.b=a+"\n"+c};a.prototype.getMessage=function(){return this.b};f[1](2,"VERSION",a)})();BotanJS.define("Components.Vim.Actions.REDO");
(function(){function a(a){this.a=a;this.t="REDO COMMAND"}var f=L("Components.Vim.Actions"),g=N("Components.Vim.Message");a.prototype.dispose=function(){};a.prototype.handler=function(a){a.preventDefault();(a=this.a.rec.redo())?(a.play(),this.t="<<TODO>>; before #"+a.id+"  "+a.time):this.t=g("REDO_LIMIT")};a.prototype.getMessage=function(){return this.t};f[1](2,"REDO",a)})();BotanJS.define("Components.Vim.Actions.PUT");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var f=L("Components.Vim.Actions"),g=N("Components.Vim.State.Stator"),k=N("Components.Vim.State.Stack"),c=N("Components.Vim.Message"),e=N("System.utils.Perf.CountSubstr");a.prototype.allowMovement=!1;a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();var h=this.a.Vim.ea.get(!1);if(!h)return!0;var d=h.length,m=e(h,"\n"),p=this.a,n=p.feeder,f=h.newLine,s=a.kMap("P")?0:-1;f&&(p.moveY(-s),
p.lineStart());a=new g(p);var w=p.aPos;n.content=n.content.substring(0,w)+h+n.content.substring(w);n.pan();p.moveTo(0<m?w:w+d,!0);h=new k;if(f){var t=a.save(d,"");h.store(function(){t();p.moveY(s)})}else h.store(a.save(d,""));p.rec.record(h);m&&(this.b=c("LINES_MORE",m));p.moveX(-1);return!0};a.prototype.getMessage=function(){return this.b};f[1](2,"PUT",a)})();BotanJS.define("Components.Vim.Actions.INSERT");
(function(){function a(a){this.a=a;this.bb=new k(a);this.v=this.u=0;this.A("",!0);a=this.a.feeder.firstBuffer.cols;for(var b=c("INSERT"),h=b.length;h<a;h++)b+=" ";this.b=b}var f=L("Components.Vim.Actions"),g=N("Components.Vim.State.Stack"),k=N("Components.Vim.State.Stator");N("System.Debug");var c=N("Components.Vim.Message");a.prototype.allowMovement=!1;a.prototype.dispose=function(){this.sa()&&this.a.feeder.pan();this.b="";this.A("",!0);this.a.moveX(-1)};a.prototype.A=function(a,b){if(b||!this.aa){if(this.aa){if(0==
this.u&&0==this.q&&""===this.s)return;this.q<this.u&&(this.u=this.q);this.aa.store(this.bb.save(this.v,this.s,-this.u));this.a.rec.record(this.aa)}this.q=0;this.s="";this.aa=new g}this.q<this.u&&(this.v=0,this.u=this.q);this.q+=a.length;this.v+=a.length};a.prototype.Ya=function(a){var b=this.a,h=b.feeder;if(a.kMap("BS")||a.kMap("S-BS")){this.ja();if(0==b.X&&0==h.panY&&0==b.Y)return;a=b.aPos-1;this.q<=this.u&&(this.s=h.content.substr(a,1)+this.s);h.content=h.content.substring(0,a)+h.content.substring(a+
1);h.pan();b.moveX(-1,!0,!0);0<this.v&&this.v--;this.q--}else if(a.kMap("Del")||a.kMap("S-Del"))this.ja(),a=b.aPos,this.s+=h.content.substr(a,1),h.content=h.content.substring(0,a)+h.content.substring(a+1),h.pan();else return;h.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))};a.prototype.handler=function(a){a.preventDefault();if(!a.ModKeys){var b;a:switch(b=a.key,b){case "Tab":b="\t";break a;case "Enter":b="\n";break a}if(1!=b.length)this.Ya(a);else{a=this.a;var h=a.feeder,d=a.aPos;h.content=
h.content.substring(0,d)+b+h.content.substring(d);"\n"==b?(h.softReset(),h.pan(),a.moveY(1),a.lineStart(),this.Sa()):(this.ja(),h.pan(),a.moveX(1,!1,!0));h.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"));this.A(b)}}};a.prototype.ja=function(){var a=this.J;if(this.J){l=a[1];for(var b=a[0];b<l;b++)this.A(this.a.feeder.content[b]);this.s=a[2]+this.s;this.J=null}};a.prototype.Sa=function(){for(var a=this.sa(),b=this.a,h=b.feeder,d=b.aPos,m=h.content.lastIndexOf("\n",d-2),c=h.content.substring(m+
1,d-1)||a;""==c&&0<m;)a=m,m=h.content.lastIndexOf("\n",a-2),c=h.content.substring(m+1,a-1);for(var a="",n=d;-1!="\t ".indexOf(h.content[n]);n++)a+=h.content[n];for(m=0;-1!="\t ".indexOf(c[m]);m++);c&&(h.content=h.content.substring(0,d)+c.substr(0,m)+h.content.substring(n),h.softReset(),h.pan(),b.moveX(m,!1,!0),b=[],b[0]=d,b[1]=d+m,b[2]=a,this.J=b)};a.prototype.sa=function(){var a=this.J;if(!a)return"";var b=this.a.feeder,h=b.content.substring(a[0],a[1]);b.content=b.content.substring(0,a[0])+b.content.substring(a[1]);
this.J=null;return h};a.prototype.getMessage=function(){return this.b};f[1](2,"INSERT",a)})();BotanJS.define("Components.Vim.Cursor");
(function(){function a(a){this.feeder=a;this.cols=a.firstBuffer.cols;this.PStart=this.Y=this.X=this.pX=0;this.PEnd=1;this.rec=new c;this.action=null;this.blink=!0;this.pSpace=!1;this.I=this.ba=0}function f(a,e){var d=a.e(),m=a.Y+e,c=a.Y;d||(d=a.feeder.firstBuffer,c=0,m=e);for(d!=a.feeder.firstBuffer&&c--;c<m&&!d.placeholder;d=d.nextLine)d.br&&c++;return c}var g=L("Components.Vim"),k=N("System.Debug"),c=N("Components.Vim.State.Recorder"),e=N("Components.Vim.Actions.*");a.prototype.Vim;a.prototype.moveTo=
function(a,e){var d=this.feeder.content,m=this.e(),c=m.lineNum;m.placeholder&&(this.Y=c=0);for(var n=0,f=0,g=d.indexOf("\n");0<=g&&!(a<=g);g=d.indexOf("\n",g))f=g,g++,n++;d=n-c;c=a<f?f-a:a-f;c+=Math.ceil(c/m.cols)-1;d&&this.moveY(d);0<this.e().lineNum&&f<=a&&c--;this.moveX(-Number.MAX_VALUE);this.moveX(c,!1,e)};a.prototype.moveX=function(a,e,d){var m=this.pX,c=Boolean(a);0<this.I&&(0<a&&d&&(a+=this.I),this.I=0);c&&(m=this.X+a);a||(a=1);var n=this.feeder;if(e&&0>m&&(0<this.feeder.panY||0<this.Y))this.moveY(-1),
this.lineEnd(d);else{var f=this.e(),g=f.visualLines.join("\n");e=g.length;var k=0,t=!0;if(1<e){for(var v=f.lineNum-1,k=n.content,t=k.indexOf("\n"),z=0;0<=t&&v!=z;t=k.indexOf("\n",t),z++)t++;0==z&&-1==t&&(t=0);v=k.indexOf("\n",t+1);v=-1==v?k.length:v;k=(t=0<(v-t-1)%f.cols)?d?e-1:e-2:d?e:e-1}f=g[m];(e=void 0==f||e==m+1&&" "==f)?m=0<m?k:0:"\n"==f&&(m+=a);n.wrap&&e&&!t&&d&&(this.I=1);this.X=m;c&&(this.pX=m,this.updatePosition())}};a.prototype.lineStart=function(){this.pX=0;this.moveX();this.updatePosition()};
a.prototype.lineEnd=function(a){this.moveX(Number.MAX_VALUE,!1,a)};a.prototype.updatePosition=function(){var a=0,e=0,d=this.feeder.lineBuffers[0];a:for(;d&&e<this.Y;e++)for(;d;){if(d.next&&d.next.placeholder)break a;a+=d.toString().length+1;if((d=d.next)&&d.br)break}this.PStart=a=this.X+a+this.I;this.PEnd=a+1;this.C()};a.prototype.C=function(){0<this.ba?k.Info("Event suppressed, suppression level is: "+this.ba):this.feeder.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))};a.prototype.moveY=
function(a){var e=this.Y+a,d=this.feeder,m;if(0>e)d.pan(void 0,e),this.Y=0,this.moveX(),this.updatePosition(),d.softReset();else if(!d.EOF&&d.moreAt<e){d=this.feeder;if(d.linesTotal<e){for(;!d.EOF;)d.pan(void 0,1);a=f(this,a)}else{m=d.lastBuffer.lineNum;var e=e-d.moreAt,c=this.e().lineNum;d.EOF||d.pan(void 0,e);for(e=c+a;!d.EOF&&(d.lastBuffer.lineNum==m||d.lastBuffer.lineNum<e);)d.pan(void 0,1);this.Y=0;for(m=this.e();m&&m.lineNum!=e&&!m.placeholder;this.Y++,m=this.e());a=this.Y;d.EOF||d.lastBuffer.next.lineNum!=
m.lineNum||a--}this.Y=a;this.moveX();this.updatePosition();d.softReset()}else{if(0<a){m=this.e();if(m.nextLine.placeholder)return;e=f(this,a)}this.Y=e;this.moveX();this.updatePosition()}};a.prototype.openAction=function(a){this.action&&this.action.dispose();k.Info("openAction: "+a);this.action=new e[a](this);this.w=null;this.C()};a.prototype.closeAction=function(){this.action&&(this.action.dispose(),this.w=this.action.getMessage(),this.action=null,k.Info("closeAction: "+this.w),this.Vim.contentAnalyzer.reset(),
this.C())};a.prototype.openRunAction=function(a,c,d,m,f,n,g){k.Info("OpenRunAction: "+a);a=new e[a](this);a.handler(c,d,m,f,n,g);this.w=a.getMessage();a.dispose();this.Vim.contentAnalyzer.reset();this.C()};a.prototype.suppressEvent=function(){++this.ba};a.prototype.unsuppressEvent=function(){--this.ba};a.prototype.e=function(){for(var a=this.feeder,e=a.firstBuffer,a=a.lastBuffer.next,d=0;e!=a;e=e.next)if(e.br&&d++,this.Y==d)return e;return null};r(a.prototype,"aX",function(){var a=this.X,e=1;if(this.feeder.wrap){var d=
this.e().visualLines,m;for(m in d){var c=d[m],n=c.content.toString().length,c=c.toString().length,a=a-(c+1);if(0<=a)e+=n;else if(0>a){e+=a+c;break}}}else return this.X;return e});r(a.prototype,"aPos",function(){var a=this.feeder,e=this.e().lineNum,d=0;if(0<e){d=a.content.indexOf("\n");for(i=1;-1!=d&&i<e;i++)d=a.content.indexOf("\n",d+1);a.wrap&&d++}return d+=this.aX});r(a.prototype,"face",function(){return"\u2588"});r(a.prototype,"message",function(){if(this.w){var a=this.w;this.w=null;return a}return this.action&&
this.action.getMessage()});r(a.prototype,"position",function(){return{start:this.PStart,end:this.PEnd}});g[1](2,"Cursor",a)})();BotanJS.define("Components.Vim.LineFeeder");
(function(){function a(a,b){var c=[];c[a]=new g(b);for(var d=a-1;0<=d;d--)c[d]=new g(b,c[d+1]);this.lineBuffers=c;this.panY=this.panX=0;this.wrap=!0;this.setRender();this.cursor=new k(this);this.dispatcher=new D;this.G=null;this.W=-1;this.L=a}var f=L("Components.Vim");N("System.Debug");var g=f[0]("LineBuffer"),k=f[0]("Cursor"),c=N("System.utils.Perf.CountSubstr");a.prototype.init=function(a,b){this.content=a;this.setWrap(b);this.firstBuffer.P(a,this.wrap,0)};a.prototype.setWrap=function(a){void 0!=
a&&(this.wrap=a)};a.prototype.setRender=function(a){void 0==a&&(a=!0);var b=this,c=a?function(){return!0}:function(a){return!a.placeholder};this.Wa=function(a,e){for(var f=(void 0==a?"":a)+"",n=!1,g=0;a&&g<e&&(a=a.next)&&c(a);g++)n||a.br&&e<g+a.visualLines.length?(n||(b.G=a),n=!0,f+="\n@"):f+="\n"+a;return f};this.Xa=function(){for(var a=b.lineBuffers[b.Va],e=b.Fa+1,f=0;a&&f<e&&(a=a.next)&&c(a);f++)if(a.br&&e<f+a.visualLines.length){b.G=a;break}}};a.prototype.render=function(a,b){var c=this.lineBuffers;
if(void 0==a)a=0;else if(this.L<a)return"";if(void 0==b||this.L-a<b)b=this.rows-a;if(0==b)return"";this.Va=a;this.Fa=b-1;return this.Wa(c[a],this.Fa)};a.prototype.pan=function(a,b){void 0==a&&(a=0);void 0==b&&(b=0);var c=this.panX+a,d=this.panY+b,m=-1,f=0;0>d&&(d=0);var n=this.content.slice(0,-1);if(0<d)for(m=n.indexOf("\n"),f=1;-1!=m&&f<d;f++){var g=n.indexOf("\n",m+1);if(-1==g){d=f;break}m=g}this.firstBuffer.P(this.content.substr(m+1),this.wrap,f);this.panX=c;this.panY=d};a.prototype.softReset=
function(){this.W=-1;this.G=null;this.Xa()};r(a.prototype,"linesTotal",function(){return c(this.content,"\n")});r(a.prototype,"firstBuffer",function(){return this.lineBuffers[0]});r(a.prototype,"lastBuffer",function(){return this.lineBuffers[this.L-1]});r(a.prototype,"EOF",function(){return this.lineBuffers[this.L].placeholder});r(a.prototype,"moreAt",function(){if(0<this.W)return this.W;var a=this.firstBuffer;if(a.placeholder)return 0;var b=0;do{if(this.G==a)break;a.br&&b++}while(a=a.next);void 0==
a&&b--;return this.W=b});r(a.prototype,"lineStat",function(){var a=this.cursor.aX+1,b=this.cursor.e(),c="",d=b.content.match(/\t/g);d&&(c="-"+(a+d.length*(b.tabWidth-1)));return b.lineNum+1+","+a+c});r(a.prototype,"docPos",function(){var a="ALL";if(0<this.panY)a=this.EOF?"BOTTOM":Math.floor(this.panY/(this.linesTotal-(this.L-1))*100)+"%";else if(this.G||!this.EOF)a="TOP";return a});r(a.prototype,"linesOccupied",function(){var a=this.firstBuffer;if(a.placeholder)return 0;var b=0;do b++;while((a=a.next)&&
!a.placeholder);return b});f[1](2,"LineFeeder",a)})();BotanJS.define("Components.Vim.StatusBar");
(function(){function a(a){this.cols=a;this.oa={};this.override=null}var f=L("Components.Vim");N("System.Debug");f[0]("LineFeeder");a.prototype.stamp=function(a,f){this.oa[a]=f};a.prototype.override;r(a.prototype,"statusText",function(){if(this.override)return this.override();for(var a="",f=this.cols,c=0;c<f;c++){var e=f-c,b=this.oa[c]||this.oa[-e];if(b){if(b=b(),void 0!=b&&""!==b){if(0==c&&f<=b.length)return b;a+=b.substr(0,e);c=a.length}}else a+=" "}return a});f[1](2,"StatusBar",a)})();BotanJS.define("Components.Vim.State.History");
(function(){function a(a){c[a]||(c[a]=[]);this.r=c[a];this.reset()}function f(a,b){var c=b.length;if(a.length<c)return!1;for(var d=0;d<c;d++)if(a[d]!=b[d])return!1;return!0}var g=L("Components.Vim.State"),k=N("System.Debug"),c={};a.prototype.push=function(a){var b;if(b=this.r.length)a:{b=this.r[this.r.length-1];for(var c=b.length<a.length?a.length:b.length,d=0;d<c;d++)if(b[d]!=a[d]){b=!1;break a}b=!0}b?k.Info("This is the previous command, skipping"):this.r.push(a)};a.prototype.prev=function(a){for(this.r.length<=
this.d&&this.reset();-1<this.d;){var b=this.r[this.d--];if(b&&f(b,a))return b.slice()}return null};a.prototype.next=function(a){0>this.d&&(this.d++,this.next(a));for(;this.d<this.r.length;){var b=this.r[this.d++];if(b&&f(b,a))return b.slice()}return null};a.prototype.reset=function(){this.d=this.r.length-1};g[1](2,"History",a)})();BotanJS.define("Components.Vim.Ex.Command");
(function(){function a(a,d){var e=this;if(!b[d])throw Error("Unsupport mode: "+d);this.a=a;this.Ma=a.Vim.statusBar;this.n=d;this.U=new c(b[d]);this.f=[];this.p=null;this.qa="ExCommandBlinkCycle"+k.uuid;this.i=0;var f=a.feeder,n=!1,E=!1;this.D=function(){E=n=!0};g.perma(this.qa,function(){E?E=!1:n=!n;f.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))},600);this.Ta=function(){for(var d="",b=e.f,c=e.i,f=b.length,g=0;g<f;g++){var p=b[g];n&&g==c&&(face=!0,p=a.face+p.substr(1));d+=p}n&&f<=c&&(d+=
a.face);return d};this.Ma.override=this.Ta}var f=L("Components.Vim.Ex"),g=N("System.Cycle");N("System.Debug");var k=N("System.utils.Perf"),c=N("Components.Vim.State.History");N("Components.Vim.Message");var e=N("Components.Vim.Beep"),b={"/":k.uuid,":":k.uuid};a.prototype.dispose=function(){this.Ma.override=null;g.permaRemove(this.qa);this.a.feeder.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))};a.prototype.handler=function(a){a.preventDefault();if(!a.ModKeys){this.D();var d=null,b=!1;if(a.kMap("Tab"))d=
"^I";else if(!a.kMap("C-v"))if(a.kMap("BS")){if(1==this.i&&1<this.f.length)return!1;this.f.splice(--this.i,1);if(0==this.f.length)return a.cancel(),!0}else if(a.kMap("Del"))this.f.splice(this.i,1);else{if(a.kMap("Enter"))return this.Ua(a),!0;if(a.kMap("Left"))1<this.i&&this.i--;else if(a.kMap("Right"))this.i<this.f.length&&this.i++;else if(b=a.kMap("Up")){this.p||(this.p=this.f);var c=this.U.prev(this.p);c?(this.f=c,this.i=c.length):e()}else(b=a.kMap("Down"))?(c=this.U.next(this.p))?(this.f=c,this.i=
c.length):this.p?(this.f=this.p,this.p=null):e():d=a.key}null!=d&&this.f.splice(this.i++,0,d);b||(this.U.reset(),this.p&&(this.p=this.f));a.cancel();this.a.feeder.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))}};a.prototype.Ua=function(a){this.U.push(this.f);var d="";switch(this.n){case "/":d="FIND";break;case ":":d="EDITOR_COMMAND"}var b=this.a;b.suppressEvent();this.a.openRunAction(d,a,this.f.slice());b.unsuppressEvent()};f[1](2,"Command",a)})();BotanJS.define("Components.Vim.Controls");
(function(){function a(a,e){this.cb=a;this.ta=!1;if("string"==typeof e)this.za=e,this.Ba=0,this.V=g(e),this.wa=27==this.V;else{this.fa=e;if(";"==e.key||":"==e.key)b=e.keyCode;var c=this.fa.keyCode;this.wa=27==c||e.ctrlKey&&67==c;this.V=c+(e.shiftKey||e.getModifierState("CapsLock")?512:0)+(e.ctrlKey?1024:0)+(e.altKey?2048:0);this.Ba=16==c||17==c||18==c;this.za=e.key}this.K=null}function f(a){this.Oa=a;this.ua=a.contentFeeder;this.F=this.ua.cursor;this.j=null}function g(a){if(h[a])return h[a];var b=
a.split("-"),e=b[0],c=0;if(2==b.length){var f=!0;switch(b[0]){case "C":c=1024;break;case "A":c=2048;break;case "S":c=512;break;default:f=!1}f&&(e=b[1])}switch(e){case "BS":b=c+8;break;case "Del":b=c+46;break;case "Enter":b=c+13;break;case "Tab":b=c+9;break;case "Up":b=c+38;break;case "Down":b=c+40;break;case "Left":b=c+37;break;case "Right":b=c+39;break;case "A":c=512;case "a":b=c+65;break;case "B":c=512;case "b":b=c+66;break;case "C":c=512;case "c":b=c+67;break;case "D":c=512;case "d":b=c+68;break;
case "E":c=512;case "e":b=c+69;break;case "F":c=512;case "f":b=c+70;break;case "G":c=512;case "g":b=c+71;break;case "H":c=512;case "h":b=c+72;break;case "I":c=512;case "i":b=c+73;break;case "J":c=512;case "j":b=c+74;break;case "K":c=512;case "k":b=c+75;break;case "L":c=512;case "l":b=c+76;break;case "M":c=512;case "m":b=c+77;break;case "N":c=512;case "n":b=c+78;break;case "O":c=512;case "o":b=c+79;break;case "P":c=512;case "p":b=c+80;break;case "Q":c=512;case "q":b=c+81;break;case "R":c=512;case "r":b=
c+82;break;case "S":c=512;case "s":b=c+83;break;case "T":c=512;case "t":b=c+84;break;case "U":c=512;case "u":b=c+85;break;case "V":c=512;case "v":b=c+86;break;case "W":c=512;case "w":b=c+87;break;case "X":c=512;case "x":b=c+88;break;case "Y":c=512;case "y":b=c+89;break;case "Z":c=512;case "z":b=c+90;break;case "!":c=512;case "1":b=c+49;break;case "@":c=512;case "2":b=c+50;break;case "#":c=512;case "3":b=c+51;break;case "$":c=512;case "4":b=c+52;break;case "%":c=512;case "5":b=c+53;break;case "^":c=
512;case "6":b=c+54;break;case "&":c=512;case "7":b=c+55;break;case "*":c=512;case "8":b=c+56;break;case "(":c=512;case "9":b=c+57;break;case ")":c=512;case "0":b=c+48;break;case "<":c=512;case ",":b=c+188;break;case ">":c=512;case ".":b=c+190;break;default:throw Error("Unsupport keys: "+a);}return h[a]=b}var k=L("Components.Vim");N("System.Debug");var c=N("Components.Vim.Ex.Command"),e=k[0]("Beep"),b=59,h={};f.prototype.g=function(a,b){if(b)this.h||(this.h=[]),this.h.push({keys:Array.prototype.slice.call(arguments,
2),handler:b,Pa:0});else{for(var c=a.keyCode,f=0;f<this.h.length;f++){var g=this.h[f],h=g.keys,k=h[g.Pa++];if(-1==k||k==c){g.Pa==h.length&&(g.handler(a),this.h=null,this.o=!1);return}}this.h&&e();this.h=null;this.o=!1}};f.prototype.Ra=function(d){var f=this.F;switch(d.keyCode){case 577:f.lineEnd();case 65:f.moveX(1,!0,!0);case 73:f.openAction("INSERT");break;case 83:""!=f.e().content&&f.openRunAction("DELETE",d,f.aPos);f.openAction("INSERT");break;case 591:f.lineStart();f.openAction("INSERT");f.action.handler(new a(d.nb,
"Enter"));f.moveY(-1);break;case 79:f.lineEnd(!0);f.openAction("INSERT");f.action.handler(new a(d.nb,"Enter"));break;case 85:f.openRunAction("UNDO",d);break;case 1106:f.openRunAction("REDO",d);break;case 68:f.openAction("DELETE");break;case 89:f.openAction("YANK");break;case 80:f.suppressEvent(),f.moveX(1,!1,!0),f.unsuppressEvent();case 592:f.openRunAction("PUT",d);break;case 600:if(!this.R(-1))break;case 88:if(""==f.e().content){e();break}f.openRunAction("DELETE",d,f.aPos);break;case 586:f.openRunAction("JOIN_LINES",
d);break;case 86:case 598:f.openAction("VISUAL");f.action.handler(d);break;case 512+b:this.j=new c(f,":"),this.j.handler(d)}};f.prototype.R=function(a,b){var c=this.F,f=c.X;c.moveX(a,b,c.pSpace);return c.X==f?(e(),!1):!0};f.prototype.ra=function(a){var b=this.F,c=this.ua,f=b.Y+c.panY;b.moveY(a);f!=b.Y+c.panY||0<a&&!c.EOF||e()};f.prototype.va=function(a){var b=a.keyCode;if(this.o&&!a.ModKeys)return this.g(a),!0;var f=this.F,g=f.feeder,h=!0;switch(b){case 8:this.R(-1,!0);break;case 72:this.R(-1);break;
case 76:this.R(1);break;case 75:this.ra(-1);break;case 74:this.ra(1);break;case 1094:if(g.firstBuffer.nextLine.placeholder){e();break}g.pan(void 0,g.moreAt);g.softReset();f.moveY(-f.Y);break;case 1090:if(0==g.panY){e();break}g.pan(void 0,-g.moreAt);g.softReset();f.moveY(-f.Y);g.EOF||f.moveY(g.moreAt);break;case 584:break;case 588:break;case 48:f.lineStart();break;case 566:f.lineStart();break;case 564:f.lineEnd(f.pSpace);break;case 583:f.moveY(Number.MAX_VALUE);f.moveX(Number.MAX_VALUE,!0);break;case 565:var k=
this.Oa.contentAnalyzer,b=k.bracketAt(f.aPos);if(-1==b.open){e();break}f.moveTo(b.selected==b.close?b.open:b.close);break;case 596:case 84:this.o=!0;this.g(a,function(b){var c=f.X;f.openRunAction("TO",a,b);f.X<c?f.moveX(1):c<f.X&&f.moveX(-1)},-1);break;case 582:case 70:this.o=!0;this.g(a,function(b){f.openRunAction("TO",a,b)},-1);break;case 87:case 599:case 66:case 578:f.openRunAction("WORD",a);break;case 73:if(!f.action){h=!1;break}k=this.Oa.contentAnalyzer;this.o=!0;this.g(a,function(a){var b=k.wordAt(f.aPos);
a.K=b},87);var b=function(a){var b=k.bracketIn("(",f.aPos);a.K=b},g=function(a){var b=k.bracketIn("{",f.aPos);a.K=b},w=function(a){var b=k.bracketIn("[",f.aPos);a.K=b};this.g(a,b,560);this.g(a,b,569);this.g(a,w,219);this.g(a,w,221);this.g(a,g,731);this.g(a,g,733);break;case 71:this.o=!0;this.g(a,function(){f.moveY(-Number.MAX_VALUE);f.moveX(-Number.MAX_VALUE,!0)},71);this.g(a,function(){f.openRunAction("PRINT_HEX",a)},56);break;case 590:case 78:f.openRunAction("FIND",a);break;case 191:this.o=!0;this.j=
new c(f,"/");this.j.handler(a);break;default:h=!1}return h};f.prototype.handler=function(a,b){if(!(2116==b.keyCode||112<b.keyCode&&123>=b.keyCode)){if(b.Escape){var c=!1;this.o=!1;this.h?(c=!0,this.h=null):this.j&&(c=!0,this.j.dispose(),this.j=null);if(c){e();return}}if(this.j&&(this.j.handler(b)&&(this.j.dispose(),this.o=!1,this.j=null),b.canceled))return;c=this.F;if(c.action)if(b.Escape)b.preventDefault(),c.closeAction();else{if(c.action.allowMovement){var f=!this.h;this.va(b);if(f&&this.h){b.preventDefault();
return}}c.action.handler(b)&&c.closeAction()}else b.preventDefault(),this.va(b)||this.Ra(b)}};a.prototype.cancel=function(){this.ta=!0};r(a.prototype,"target",function(){return this.cb});r(a.prototype,"key",function(){return this.za});r(a.prototype,"keyCode",function(){return this.V});r(a.prototype,"ModKeys",function(){return this.Ba});r(a.prototype,"Escape",function(){return this.wa});r(a.prototype,"canceled",function(){return this.ta});r(a.prototype,"range",function(){var a=this.K;return a&&-1==
a.open&&-1==a.close?null:a});a.prototype.kMap=function(a){return this.V==g(a)};a.prototype.preventDefault=function(){this.fa&&this.fa.preventDefault()};k[1](2,"Controls",f);k[1](2,"InputEvent",a)})();BotanJS.define("Components.Vim.VimArea");
(function(){function a(a,b){if(!a)throw Error("Invalid argument");a=k(a);var d=a.element;if(!d||"TEXTAREA"!=d.nodeName)throw Error("This element is not compatible for VimArea");for(var f in t){var g=t[f];if(g.stage.element==d)return h.Info("Instance exists"),g}a.setAttribute(new c("vimarea",1));this.stage=a;this.rows=d.rows;this.cols=d.cols;this.Q=!1;var m=this;this.ma=[new e("Focus",function(){m.Q=!0}),new e("Blur",function(){m.Q=!1})];if(b){var n=d.value;this.eb(function(){m.pa(n)})}else this.pa(d.value);
this.ga=v++;t[this.ga]=this}function f(a,b){return function(c){a.Q=!0;c=c||window.event;c.keyCode?code=c.keyCode:c.which&&(code=c.which);b(a,new s(a,c))}}var g=L("Components.Vim"),k=N("Dandelion.IDOMElement"),c=N("System.utils.DataKey"),e=N("System.utils.EventKey"),b=N("System.Cycle"),h=N("System.Debug"),d=N("Components.Vim.State.Registers"),m=N("Components.Vim.Syntax.Analyzer"),p=g[0]("LineFeeder"),n=g[0]("StatusBar"),E=g[0]("Controls"),s=g[0]("InputEvent"),w=g[0]("Message"),t=[],v=0;a.prototype.eb=
function(a){function c(){f.value+=e();++m;k==f.scrollHeight?b.next(c):(n.rows=m,n.cols=g,a())}function d(){f.value+=e();if(h==f.scrollWidth)b.next(d);else{var a="";--g;for(var k=0;k<g;k++)a+=".";f.value=a;f.style.whiteSpace="";e=function(){return"\n"+a};c()}}function e(){return"Please wait while Vim;Re is testing for screen dimensions"[g++]||"."}var f=this.stage.element;f.value="";var g=0;f.style.whiteSpace="nowrap";var h=f.scrollWidth;d();var k=f.scrollHeight,m=0,n=this};a.prototype.select=function(a){if(this.Q){var b=
this.stage.element;a&&(b.selectionStart=a.start,b.selectionEnd=a.end)}};a.prototype.pa=function(a){function c(){C.init(F.statusText);var a=C.linesOccupied;h.value=s.render(a-1,k-a)+"\n"+C.render(0,a<k?a:k);g.D=!1;g.select(s.cursor.position)}var g=this;this.content=a;var h=this.stage.element,k=this.rows,t=this.cols,s=new p(k-1,t),v=new m(s);s.init(a+"\n");var C=new p(k,t);C.setRender(!1);s.cursor.Vim=this;C.cursor.Vim=this;var F=new n(t);F.stamp(-18,function(){return s.lineStat});F.stamp(-3,function(){return w(s.docPos)});
F.stamp(0,function(){return s.cursor.message});C.init(F.statusText);s.dispatcher.addEventListener("SelectionChanged",function(){g.select(s.cursor.position)});s.dispatcher.addEventListener("VisualUpdate",c);h.value="Please wait ...";b.delay(c,70);this.C=c;this.contentFeeder=s;this.contentAnalyzer=v;this.statusFeeder=C;this.statusBar=F;this.ea=new d;this.a=s.cursor;this.D=!0;b.perma("VimCursorBlinkCycle"+h.id,function(){g.select(!g.a.blink||(g.D=!g.D)?g.a.position:{start:0,end:0})},600);a=new E(this);
this.ma.push(new e("KeyDown",f(this,a.handler.bind(a))));this.stage.addEventListeners(this.ma)};a.prototype.dispose=function(){var a=this.stage,c=this.ma,d=this.contentFeeder,e=a.element.id;h.Info("Destroy instance: "+e);d.dispatcher.removeEventListener("VisualUpdate",this.C);a.removeAttribute("data-vimarea");b.permaRemove("VimCursorBlinkCycle"+e);for(var f in c)a.removeEventListener(c[f]);a.element.value=this.content;delete t[this.ga]};r(a.prototype,"index",function(){return this.ga+1});r(a,"Instances",
function(){var a=[],b;for(b in t)a.push(t[b]);return a});g[1](2,"VimArea",a)})();})();
