(function(){function q(a,c){a.prototype=Object.create(c.prototype);a.prototype.constructor=a}function s(a,c,f){Object.defineProperty(a,c,{get:f,set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:c})})}function w(a,c){Object.defineProperty(a,"propagating",{get:c,set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:"propagating"})})}
function D(a,c,f){Object.defineProperty(a,c,{get:function(){return f},set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:c})})}function BotanEvent(a,c){var f=!1,n=!1;D(this,"propagate",function(){n||(f=!0);n=!0});D(this,"stopPropagating",function(){f=!1});D(this,"type",a);w(this,function(){return f});D(this,"data",c);this.setTarget=function(a){D(this,"target",a);this.setTarget=void 0}.bind(this)}
function K(){function a(){this.fa.propagate();for(var a in this.stack)if(this.fa.propagating)this.stack[a](this.fa);this.fa.stopPropagating()}function c(a){f[a]||(f[a]=[]);return f[a]}var f={},n=this;this.addEventListener=function(a,e){var b=c(a);b[b.length]=e};this.removeEventListener=function(a,e){var b=c(a),m=b.indexOf(e);0>m||delete b[m]};this.dispatchEvent=function(h){var e=c(h.type);h.setTarget&&h.setTarget(n);setTimeout(a.bind({fa:h,stack:e}),0)}}function L(){K.call(this)}L.prototype=[];
var N={},O={},Q={},R=window.BotanJS,BotanJS=null,S=null,U=null;R&&(BotanJS=R.sg[0],S=R.sg[1],U=R.sg[2]);BotanJS=BotanJS||function(){var a=0,c=[],f=[],n=new K,h={write:function(a){c[c.length]=a}};D(h,"read",function(){return c[a++]});D(h,"end",function(){return c.length<=a});D(n,"log",h);D(n,"define",function(a){f[f.length]=a});D(n,"getDef",function(){return f.slice()});return n}();
S=S||function(a){if(O[a])return O[a];for(var c=a.split("."),f=c.length,n=N,h=0;h<f;h++)n[c[h]]=n[c[h]]||{},n=n[c[h]];n.Wa=[];nsObj=new L;nsObj[1]=function(a,b,m){this.m[b]||(this.m[b]=[a,m],a=new BotanEvent("NS_EXPORT",{name:this.P+"."+b,type:a}),BotanJS.dispatchEvent(a))}.bind({m:n,P:a});nsObj[0]=function(a){if(!this.m[a])throw Error("["+this.P+"] Invoke failed: "+a+" does not exists");return this.m[a][1]}.bind({m:n,P:a});nsObj[10]=function(a,b){this.Wa[a]=b}.bind(n);nsObj[11]=function(a,b){throw Error("["+
this.P+(b?"."+b:"")+"] "+a);}.bind({P:a});BotanJS.dispatchEvent(new BotanEvent("NS_INIT",a));return O[a]=nsObj};
U=U||function(a,c){var f=a.replace(".*","");O[f]&&O[f].dispatchEvent(new BotanEvent("NS_IMPORT",e));if(!c&&Q[a])return Q[a];for(var n=a.split("."),h=n.length,e=N,f=!1,b=0;b<h;b++){if("*"==n[b]){f=!0;break}e=e[n[b]];if(!e)throw Error("No such class: "+a);}if(e instanceof Array&&"*"!=n[b])return f=null,f=10==e[0]?e[1]():e[1],Q[a]=f;n={};for(b in e)h=e[b],h instanceof Array&&(f&&2==h[0]?n[b]=h[1]:3==h[0]?n[b]=h[1]:0==h[0]?Object.defineProperty(n,b,{get:function(){return this.m[this.c][1]}.bind({c:b,
m:e}),set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:b})}):1==h[0]?Object.defineProperty(n,b,{get:function(){return this.m[this.c][1]()}.bind({c:b,m:e}),set:function(b){this.m[this.c][1](b)}.bind({c:b,m:e})}):10==h[0]&&Object.defineProperty(n,b,{get:h[1],set:function(){throw Error("Setting a read-only property: "+this.c);}.bind({c:b})}));return Q[a]=n};window.BotanJS={};window.BotanJS.version="1.0.0b";window.BotanJS.codename="Botanical framework.js";
window.BotanJS["import"]=function(a){try{return U(a)}catch(c){if(R)return R["import"](a);throw c;}};window.BotanJS.sg=[BotanJS,S,U];BotanJS.define("System.utils.IKey");
(function(){function a(f,n){f&&"string"!=typeof f||(this.keyName=f,this.keyValue=n instanceof a?n:void 0!=n?String(n):"",this.keyName=this.keyName,this.keyValue=this.keyValue)}var c=S("System.utils");a.prototype.keyName="";a.prototype.keyValue="";D(a,"quickDef",function(){var f=arguments.length;if(0!=f%2)c[11]("Invalid Definition Count","IKey");for(var n=[],h=0;h<f;h+=2)n[n.length]=new a(arguments[h],arguments[h+1]);return n});c[1](2,"IKey",a)})();BotanJS.define("System.utils.Perf");
(function(){for(var a=S("System.utils.Perf"),c=[],f=0;256>f;f++)c[f]=(16>f?"0":"")+f.toString(16);a[1](10,"uuid",function(){var a=4294967295*Math.random()|0,h=4294967295*Math.random()|0,e=4294967295*Math.random()|0,b=4294967295*Math.random()|0;return c[a&255]+c[a>>8&255]+c[a>>16&255]+c[a>>24&255]+"-"+c[h&255]+c[h>>8&255]+"-"+c[h>>16&15|64]+c[h>>24&255]+"-"+c[e&63|128]+c[e>>8&255]+"-"+c[e>>16&255]+c[e>>24&255]+c[b&255]+c[b>>8&255]+c[b>>16&255]+c[b>>24&255]});a[1](3,"CountSubstr",function(a,h){if(0>=
h.length)return a.length+1;for(var e=0,b=a.indexOf(h);0<=b;b=a.indexOf(h,b))e++,b++;return e});a[1](3,"ArrayReverse",function(a){for(var h=null,e=a.length,b=null,h=0,b=e-1;h<b;h+=1,--b){var e=a[h],m=a[b],e=e^m,m=m^e,e=e^m;a[h]=e;a[b]=m}})})();BotanJS.define("System.Global");
(function(){var a=S("System.Global"),c=Boolean(document.all),f=window.allowed_origins||[],n=window.location.href.match(/^https:\/\//);a[1](10,"debug",function(){return window.debugEnv&&window.debugEnv});a[1](0,"IE",c);a[1](0,"ALLOWED_ORIGINS",f);a[1](0,"SECURE_HTTP",n)})();BotanJS.define("Dandelion");
(function(){function a(){if(k)return!0;try{return k=U("Dandelion.IDOMElement"),!0}catch(b){}return!1}function c(b,d){if(d&&a()){for(var g=b.length,m=[],e=0;e<g;e++)m[e]=k(b[e]);return m}return b}function f(b,d){b&&d(b)&&b.parentNode&&f(b.parentNode,d)}function n(b,d){return d(b)?b:b.parentNode&&n(b.parentNode,d)}function h(b){return document.createTextNode(b)}function e(a,k,m,e,h){a=document.createElement(a||"div");k&&(a.id=k);m&&(d?a.className=m:a.setAttribute("class",m));if(h)if(h instanceof Array)for(var f in h)a.setAttribute(h[f].keyName,
h[f].keyValue);else h instanceof g&&a.setAttribute(h.keyName,h.keyValue);e&&b(a,e);return a}function b(d,g){if(g instanceof Array)for(var a=g.length,k=0;k<a;k++)g[k]&&b(d,g[k]);else"string"==typeof g?d.appendChild(h(g)):g&&d.appendChild(g)}var m=S("Dandelion"),d=U("System.Global.IE"),g=U("System.utils.IKey"),k;m[1](3,"wrap",e);m[1](3,"wrapc",function(b,d,g){return e(!1,!1,b,d,g)});m[1](3,"wrape",function(b,d){return e(!1,!1,!1,b,d)});m[1](3,"wrapne",function(b,d,g){return e(b,!1,!1,d,g)});m[1](3,
"wrapna",function(b,d){return e(b,!1,!1,!1,d)});m[1](3,"textNode",h);m[1](3,"bubbleUp",n);m[1](3,"chainUpApply",f);m[1](3,"id",function(b,d){var g=document.getElementById(b);return g?d&&a()?k(g):g:g});m[1](3,"tag",function(b,d,g){g=void 0===g?document:g;return c(g.getElementsByTagName(b),d)});m[1](3,"name",function(b,d,g){g=void 0===g?document:g;return c(g.getElementsByName(b),d)});m[1](3,"glass",function(b,d,g){g=void 0===g?document:g;return c(g.getElementsByClassName(b),d)})})();BotanJS.define("System.utils.EventKey");
(function(){function a(a,h){f.call(this,a,h);this.type=a.toLowerCase();this.handler=h}var c=S("System.utils"),f=c[0]("IKey");q(a,f);a.prototype.type="";a.prototype.handler=null;c[1](2,"EventKey",a)})();BotanJS.define("Dandelion.IDOMObject");
(function(){function a(h,e){if(h instanceof a)return h;if(e)this.addEventListener=this.addEventListener.bind(h),this.addEventListeners=this.addEventListeners.bind(this),this.hasListener=this.hasListener.bind(h),this.removeEventListener=this.removeEventListener.bind(h);else{if(h)return new a(h,!0);throw Error("[Dandelion.IDOMObject] Invalid argument");}}function c(){}var f=S("Dandelion"),n=U("System.utils.EventKey");c.prototype.indexOf=function(a){for(var e=this.length,b=0;b<e;b++){var m=this[b];if(m.type==
a.type&&m.handler==a.handler)return b}return-1};q(c,Array);a.prototype.hasListener=function(a){return a instanceof n&&this.l&&-1!=this.l.indexOf(a)?this.l[this.l.indexOf(a)]:null};a.prototype.addEventListener=function(a,e){var b;if("string"==typeof a&&e)b=new n(a,e);else if(a instanceof n)b=a;else return!1;if(this.l)if(0>this.l.indexOf(b))this.l.push(b);else return!1;else this.l=new c,this.l[0]=b;this.addEventListener?this.addEventListener(b.type,b.handler,!1):this.attachEvent?this.attachEvent("on"+
b.type,b.handler):this["on"+b.type]=b.handler;return!0};a.prototype.addEventListeners=function(a){if(a instanceof Array)for(var e in a)this.addEventListener(a[e])};a.prototype.removeEventListener=function(a,e){e&&(a=new n(a,e));this.l&&delete this.l[this.l.indexOf(a)];this.removeEventListener?this.removeEventListener(a.type,a.handler):this.detachEvent?this.detachEvent("on"+a.type,a.handler):this["on"+a.type]=null};f[1](2,"IDOMObject",a)})();BotanJS.define("Dandelion.IDOMElement");
(function(){function a(b){b=typeof b;return"number"==b?f:"string"==b?c:n}function c(b,d){return b.nodeName==d}function f(b,d){return b.nodeType==d}function n(){return!1}function h(b,a){if(b instanceof h)return b;if(a)d.call(this,b,!0),this.getDAttribute=this.getDAttribute.bind(b),this.lootChildren=this.lootChildren.bind(b),this.foreach=this.foreach.bind(b),this.reverseChild=this.reverseChild.bind(b),this.first=this.first.bind(b),this.last=this.last.bind(b),this.contains=this.contains.bind(b),this.style=
b.style,this.hasAttribute=function(){}.bind(b),this.removeAttribute=function(b){this.removeAttribute(b)}.bind(b),this.element=b,this.setAttribute=this.setAttribute.bind(b);else{if(b&&void 0!=b.nodeType&&1==b.nodeType)return new h(b,!0);if(void 0===b)return new h(m(),!0);throw Error("[Dandelion.IDOMElement] Invalid argument");}return this}var e=S("Dandelion"),b=U("System.utils.IKey");U("System.utils.Perf");var m=e[0]("wrap"),d=e[0]("IDOMObject");q(h,d);h.prototype.setAttribute=function(d,a){if(d instanceof
b)this.setAttribute(d.keyName,d.keyValue);else if(d instanceof Array)for(var m in d)d[m]instanceof b&&this.setAttribute(d[m].keyName,d[m].keyValue);else this.setAttribute(d,a)};h.prototype.lootChildren=function(b){for(var d=b.childNodes;d.length;)this.appendChild(b.removeChild(d[0]))};h.prototype.getDAttribute=function(b){return(b=this.getAttribute("data-"+b))&&decodeURIComponent(b)};h.prototype.foreach=function(b,d){for(var a=Array.apply([],this.childNodes),m=a.length,e=0;e<m;e++)a[e].nodeType==
b&&d(a[e],this)};h.prototype.first=function(b,d){for(var m=this.childNodes,e=m.length,h=null,f=a(b),n=0;n<e;n++)if(f(m[n],b)&&(void 0===d||d(m[n],this))){h=m[n];break}return h};h.prototype.last=function(b,d){for(var m=this.childNodes,e=null,h=a(b),f=m.length-1;-1<f;f--)if(h(m[f],b)&&(void 0===d||d(m[f],this))){e=m[f];break}return e};h.prototype.contains=function(b){return b.parentElement?b==this?!0:this.contains(b.parentElement):!1};h.prototype.aKeys=function(){for(var d=[],a=this.element.attributes,
m=a.length,e=0;e<m;e++)d.push(new b(a[e].name,a[e].value));return d};h.prototype.reverseChild=function(){for(var b=this.childNodes.length-1;-1<--b;)this.appendChild(this.childNodes[b])};e[1](2,"IDOMElement",h)})();BotanJS.define("System.utils.DataKey");(function(){function a(a,h){f.call(this,"data-"+a,h?encodeURIComponent(String(h)):"")}var c=S("System.utils"),f=c[0]("IKey");q(a,f);c[1](2,"DataKey",a)})();BotanJS.define("System.utils");
(function(){var a=S("System.utils"),c=U("System.Global");a[1](3,"objGetProp",function(a,n,h){if(a&&a[n]){var e=a[n].constructor.toString().match(/function ([^\(]+)/);if(e&&2==e.length&&e[1].toUpperCase()==h.toUpperCase())return a[n]}return null});a[1](3,"objSearch",function(a,n,h){for(var e in a)if(n(a[e]))return a[e][h]||a[e];return null});a[1](3,"objMap",function(a,n){for(var h in a)a[h]=n(a[h])});a[1](3,"siteProto",function(a){return a.match(/^https?:\/\//)?c.SECURE_HTTP?a.replace(/^http:\/\//,
"https://"):a.replace(/^https:\/\//,"http://"):"http"+(c.SECURE_HTTP?"s":"")+"://"+a})})();BotanJS.define("System.Tick");
(function(){function a(){var a=0;this.N=!1;this.loop=function(){for(var n in this.steppers)this.steppers[n]();a++};s(this,"count",function(){return a})}var c=S("System");a.prototype.putStepper=function(a){var n=this.steppers.length;this.steppers[n]=a;return n};a.prototype.start=function(){this.N||(this.id=setInterval(this.loop.bind(this),0),this.N=!0)};a.prototype.stop=function(){this.N&&(this.N=!1,clearInterval(this.id))};a.prototype.steppers=[];s(a.prototype,"started",function(){return this.N});
c[1](2,"Tick",a)})();BotanJS.define("System.Log");(function(){var a=S("System.Log"),c=[];a[1](3,"writeLine",function(a,n){n=void 0===n?16:n;var h=!1,e;for(e in c)c[e](a,n),h=!0;!h&&window.console&&console.log&&console.log(a)});a[1](3,"registerHandler",function(a){var n=-1;c[n=c.length]=a;return n});a[1](3,"removeHandler",function(a){delete c[a]});a[1](0,"INFO",16);a[1](0,"ERROR",32);a[1](0,"SYSTEM",1)})();BotanJS.define("System.Debug");
(function(){function a(){n&&f.writeLine(Array.prototype.join.call(arguments," "),f.INFO)}var c=S("System.Debug"),f=U("System.Log"),n=U("System.Global").debug,h=!0;for(BotanJS.log.write=a;!BotanJS.log.end();)a(BotanJS.log.read());c[1](3,"Error",function(a){h&&f.writeLine(a.name+"\n\t"+a.message+"\n\t"+a.stack,f.ERROR)});c[1](3,"Info",a);c[1](3,"turnOff",function(a){"info"==a?n=!1:"error"==a&&(h=!1)});c[1](3,"turnOn",function(a){"info"==a?n=!0:"error"==a&&(h=!0)})})();BotanJS.define("System.Cycle");
(function(){function a(b){b.target.removeEventListener("NS_IMPORT",a);b=U("System.Cycle.TICK",!0);b!=e&&b.vb?(n.Info("[System.Cycle] Global Tick exists"),e=null):(n.Info("[System.Cycle] Creating global Tick"),e.start())}var c=S("System.Cycle");U("System.utils");var f=U("System.Tick"),n=U("System.Debug"),h=[],e=new f;e.putStepper(function(){var b=(new Date).getTime(),a;for(a in h){var d=h[a];if(d&&b>d[1]){try{d[0]()}catch(g){n.Error(g);delete h[a];continue}d[2]?delete h[a]:d[1]=b+d[4]}}});c.addEventListener("NS_IMPORT",
a);c[1](3,"next",function(b){var a=[];a[0]=b;a[1]=0;a[2]=!0;h[h.length]=a});c[1](3,"delay",function(b,a){var d=[];d[0]=b;d[1]=(new Date).getTime()+a;d[2]=!0;h[h.length]=d});c[1](3,"perma",function(b,a,d){for(var g in h)if(h[g][3]==b)return!1;g=[];g[0]=a;g[1]=(new Date).getTime()+d;g[2]=!1;g[3]=b;g[4]=d;h[h.length]=g});c[1](3,"permaRemove",function(b){for(var a in h)h[a][3]==b&&delete h[a]});c[1](10,"TICK",function(){return e})})();BotanJS.define("Components.Vim.State.Registers");
(function(){function a(){this.ba={}}function c(a,e){this.pa=a+"";this.newLine=Boolean(e)}var f=S("Components.Vim.State"),n=U("System.Debug");c.prototype.newLine=!1;c.prototype.toString=function(){return this.pa};c.prototype.indexOf=function(a,e){return this.pa.indexOf(a,e)};s(c.prototype,"length",function(){return this.pa.length});a.prototype.Ta=function(a){this.ba['"']=a};a.prototype.yank=function(a,e){var b=new c(a,e);this.Ta(b);this.ba[this.M||0]=b;this.M=!1};a.prototype.change=function(a,e){var b=
new c(a,e);this.Ta(b);for(var m=this.ba,d=9;1<d;d--)void 0!=m[d-1]&&(m[d]=m[d-1]);m[1]=b;this.M=!1};a.prototype.get=function(a){a||0===a||(a=this.M||'"');this.M=!1;return this.ba[a]};a.prototype.select=function(a){n.Info("Selecting Register: "+a);this.M=a};f[1](2,"Registers",a)})();BotanJS.define("Components.Vim.Syntax.Word");
(function(){function a(a){a:{a=a.charCodeAt(0);for(var e=0;e<n;e++)for(var b=f[e],m=b.length,d=0;d<m;d++){var g=b[d];if(g[0]<=a&&a<=g[1]){a=b;break a}}a=[]}this.qb=a}var c=S("Components.Vim.Syntax"),f=[[[48,57]],[[65,90],[97,122],[192,255],[256,383],[384,591],[7424,7551],[7552,7615],[7616,7679],[7680,7935],[7936,8191]],[[592,687],[688,767],[768,879],[880,1023],[1024,1279],[1280,1327],[1328,1423]],[[1424,1535],[1536,1791],[1792,1871],[1872,1919],[1920,1983],[1984,2047],[2048,2111],[2112,2143],[2208,
2303]],[[2304,2431],[2432,2559],[2560,2687],[2688,2815],[2816,2943],[2944,3071],[3072,3199],[3200,3327],[3328,3455],[3456,3583],[3584,3711],[3712,3839],[3840,4095],[4096,4255],[4256,4351],[4352,4607],[4608,4991],[4992,5023],[5024,5119],[5120,5759],[5760,5791],[5792,5887]],[[5888,5919],[5920,5951],[5952,5983],[5984,6015],[6016,6143],[6144,6319],[6320,6399],[6400,6479]],[[6480,6527],[6528,6623],[6624,6655],[6656,6687],[6688,6831],[6832,6911],[6912,7039],[7040,7103],[7104,7167],[7168,7247],[7248,7295],
[7360,7375],[7376,7423]],[[8192,8303],[8304,8351],[8352,8399],[8400,8447],[8448,8527],[8528,8591],[8592,8703],[8704,8959],[8960,9215],[9216,9279],[9280,9311],[9312,9471],[9472,9599],[9600,9631],[9632,9727],[9728,9983],[9984,10175],[10176,10223],[10224,10239],[10240,10495],[10496,10623],[10624,10751],[10752,11007],[11008,11263],[11264,11359],[11360,11391],[11392,11519],[11520,11567],[11568,11647],[11648,11743],[11744,11775],[11776,11903]],[[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12352,
12447],[12448,12543],[12544,12591],[12592,12687],[12688,12703],[12704,12735],[12736,12783],[12784,12799],[12800,13055],[13056,13311],[13312,19903],[19904,19967],[19968,40959],[40960,42127],[42128,42191],[42192,42239],[42240,42559],[42560,42655],[42656,42751],[42752,42783],[42784,43007],[43008,43055],[43056,43071],[43072,43135],[43136,43231],[43232,43263],[43264,43311],[43312,43359],[43360,43391],[43392,43487],[43488,43519],[43520,43615],[43616,43647],[43648,43743],[43744,43775],[43776,43823],[43824,
43887],[43888,43967],[43968,44031],[44032,55215],[55216,55295]],[[55296,56319],[56320,57343],[57344,63743],[63744,64255],[64256,64335],[64336,65023],[65024,65039],[65040,65055],[65056,65071],[65072,65103],[65104,65135],[65136,65279],[65280,65519],[65520,65535]],[[33,47],[58,64],[91,96],[123,126],[161,172],[174,191]],[[32,32],[9,9]]],n=f.length;a.prototype.test=function(a){if(void 0==a||null==a||!a.charCodeAt)return!1;var e=this.qb,b=e.length;a=a.charCodeAt(0);for(var m=0;m<b;m++){var d=e[m];if(d[0]<=
a&&a<=d[1])return!0}return!1};c[1](2,"Word",a)})();BotanJS.define("Components.Vim.Syntax.Analyzer");
(function(){function a(){this.Ea=this.Pa=this.U=this.aa=-1;this.Ja=null}function c(b){this.V=b;this.ea={}}function f(b,d){if(!d)throw Error("Parent not found");var g=new a;g.Ea=d[2];g.aa=d[0];g.U=d[1];if(-1<d[3]){var k=b.find(d[3]);g.Ja=f(b,k)}return g}function n(b,a){for(var g=a.length,k=b.split("\n"),n=k[0],k=k[1],p=[],f=[],h=0,c=[],x=n.length,A=k.length,z=0;z<g;z++){var r=a.substr(z,A);if(a.substr(z,x)==n)p[h]=z,h++,z+=x-1;else if(r==k){r=z;if(0==h)f.push(r);else{var C=[];C[0]=p[--h];C[1]=r;C[2]=
h;C[3]=0<h?p[h-1]:-1;c.push(C)}z+=A-1}}f.length&&e.Info('Unmatched opening "'+n+'"@'+f.join(", "));0<h&&e.Info('Unmatched closing "'+k+'"@'+p.slice(0,h));this.Ha=c}var h=S("Components.Vim.Syntax"),e=U("System.Debug"),b=h[0]("Word");n.prototype.find=function(b,a){void 0==a&&(a=0);for(var g=this.Ha,k=g.length,e=0;e<k;e++){var p=g[e];if(p[a]==b)return p}return null};c.prototype.bracketAt=function(b){var d=this.V.content,g=1,k=null,e=d[b];switch(e){case "{":g=0;case "}":k=this.H("{\n}");break;case "[":g=
0;case "]":k=this.H("[\n]");break;case "(":g=0;case ")":k=this.H("(\n)");break;case "/":if("*"==d[b-1]){e="*/";b--;break}else if("*"==d[b+1]){e="/*";break}return new a;case "*":if("/"==d[b-1]){e="/*";b--;break}else if("/"==d[b+1]){e="*/";break}return new a;default:return new a}if(!k)switch(e){case "/*":g=0;case "*/":k=this.H("/*\n*/");break;default:return new a}d=k.find(b,g);k=f(k,d);k.Pa=b;return k};c.prototype.bracketIn=function(b,d){var g="{[(".indexOf(b);0>g&&(g="}])".indexOf(b));if(0>g)throw Error("Unsupported bracket: "+
b);for(var k=this.H("{[("[g]+"\n"+"}])"[g]),e=k.Ha,p=e.length,n=null,g=0;g<p;g++){var h=e[g];h[0]<=d&&d<=h[1]&&(n&&n[2]<h[2]||!n)&&(n=h)}if(n){k=g=f(k,n);do k.aa++,k.U--;while(k=k.parent);return g}return new a};c.prototype.H=function(b){if(this.ea[b])return this.ea[b];var a=new n(b,this.V.content);return this.ea[b]=a};c.prototype.reset=function(){this.ea={}};c.prototype.quoteAt=function(b){switch(this.V.content[b]){default:return{level:0,open:-1,close:-1}}};c.prototype.wordAt=function(e){var d=this.V.content,
g=d.length,k=e,n=e,p=new b(d[e]);if(0<e)for(;p.test(d[--k]););if(e<g)for(;p.test(d[++n]););e=new a;e.aa=0<k?k+1:0;e.U=n-1;return e};s(a.prototype,"parent",function(){return this.Ja});s(a.prototype,"open",function(){return this.aa});s(a.prototype,"close",function(){return this.U});s(a.prototype,"level",function(){return this.Ea});s(a.prototype,"selected",function(){return this.Pa});h[1](2,"Analyzer",c);h[1](2,"TokenMatch",a)})();BotanJS.define("Components.Vim.LineBuffer");
(function(){function a(a,h){this.prev=null;this.cols=a;this.next=h;this.br=!1;this.placeholder=!0;this.lineNum=0;this.tabWidth=8;h&&(h.prev=this)}var c=S("Components.Vim");U("System.Debug");var f=U("System.utils.Perf.CountSubstr");a.prototype.R=function(a,h,e){this.lineNum=e;if(void 0==a||""===a)this.lineNum=++e,this.content="~",this.placeholder=this.br=!0,this.next&&this.next.R(a,h,e+1);else{this.placeholder=!1;var b="",m=!1,d=0,g=0,k=this.tabWidth-1;if(h){for(;d<this.cols-g*k;d++){var f=a[d];if(void 0===
f)break;if("\n"==f){m=!0;d++;break}else"\t"==f&&g++;b+=f}m||d!=this.cols||"\n"!=a[d]||(d++,m=!0)}else for(m=!0;;d++){f=a[d];if(void 0===f)break;if("\n"==f){d++;break}else"\t"==f&&g++;d<this.cols-g*k&&(b+=f)}this.next&&(this.next.br=m,this.next.R(a.substr(d),h,m?e+1:e));this.content=b}};a.prototype.toString=function(){var a=this.cols-f(this.content,"\t")*(this.tabWidth-1);return this.content.length<a?this.content+" ":this.content||" "};s(a.prototype,"nextLine",function(){for(var a=this,f=this.lineNum;(a=
a.next)&&a.lineNum==f;);return a});s(a.prototype,"visualLines",function(){for(var a=[this],f=this;(f=f.next)&&!f.br;)a.push(f);return a});c[1](2,"LineBuffer",a)})();BotanJS.define("Components.Vim.State.Recorder");
(function(){function a(){this.O=[];this.gb=[];this.Oa=this.Ca=this.f=0}var c=S("Components.Vim.State");a.prototype.undo=function(){var a=this.f-1;return-1!=a&&this.O.length?this.O[this.f=a]:null};a.prototype.redo=function(){var a=this.O[this.f];return a?(this.f++,a):null};a.prototype.save=function(){this.Oa=this.f};a.prototype.record=function(a){this.O[this.f++]=a;this.gb[this.Ca++]=a;delete this.O[this.f];a.id=this.Ca};s(a.prototype,"changed",function(){return this.Oa!=this.f});c[1](2,"Recorder",
a)})();BotanJS.define("Components.Vim");VIMRE_VERSION="1.0.0b";
(function(){function a(a,b,m){if(void 0==a[b])return b;var d=0;return a[b].replace(/%\d+/g,function(){return m[d++]})}var c=S("Components.Vim"),f={INSERT:"-- INSERT --",REPLACE:"-- REPLACE --",MORE:"-- MORE --",VISUAL:"-- VISUAL  --",VISLINE:"-- VISUAL LINE --",REGISTERS:"--- Registers ---",WRITE:'"%1" %2L, %3C written',WAIT_FOR_INPUT:"Press ENTER or type command to continue",SEARCH_HIT_BOTTOM:"Seach hit BOTTOM, contining at TOP",TOP:"Top",BOTTOM:"Bot",ALL:"All",EXIT:"Type :quit<Enter>  to exit Vim",
UNDO_LIMIT:"Already at oldest change",REDO_LIMIT:"Already at newest change",NCHANGES:"%1 change(s); before #%2  %3",LINES_FEWER:"%1 fewer line(s)",LINES_MORE:"%1 more line(s)",LINES_YANKED:"%1 line(s) yanked",LINES_SHIFTED:"%1 line(s) %2ed %3 time(s)",NO_SHIFT:"No line to %1",SEARCH_HIT_BOTTOM:"search hit BOTTOM, continuing at TOP",SEARCH_HIT_TOP:"search hit TOP, continuing at BOTTOM",REPLACE:"%1 substitution(s) on %2 line(s)"},n={E35:"No previous regular expression",E37:"No write since last change (add ! to override)",
E481:"No range allowed",E492:"Not an editor command: %1",E486:"Pattern not found: %1",EX1:"Pattern Error( %1 )",EX2:"This pattern is causing infinite loop: %1",TODO:"%1 is not implemented yet",MISSING_FEATURE:'Sorry, I thought this command wasn\'t useful enough to implement. Please file a feature request titled "Implement %1" in github if you think this is important.'},h=new Audio("data:audio/ogg;base64,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");
c[1](3,"Message",function(e){return a(f,e,Array.prototype.slice.call(arguments,1))});c[1](3,"Error",function(e){return e+": "+a(n,e,Array.prototype.slice.call(arguments,1))});c[1](3,"Beep",function(){setTimeout(function(){h.pause();h.currentTime=0;h.play()},0)})})();BotanJS.define("Components.Vim.Actions.WRITE");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var c=S("Components.Vim.Actions");U("System.Debug");var f=U("Components.Vim.Message"),n=U("System.utils.Perf.CountSubstr");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();var e=this.a;a=e.Vim;a.content=e.feeder.content.slice(0,-1);a=f("WRITE",a.stage.element.id,n(a.content,"\n"),a.content.length);e.rec.save();for(var e=this.a.feeder.firstBuffer.cols,b=a.length;b<e;b++)a+=" ";
this.b=a};a.prototype.getMessage=function(){return this.b};c[1](2,"WRITE",a)})();BotanJS.define("Components.Vim.DateTime.String");
(function(){function a(a,n,h){if(void 0==a[n])return n;var e=0;return a[n].replace(/%\d+/g,function(){return h[e++]})}var c={AboutAMinuteAgo:"about a minute ago",AboutAMonthAgo:"about a month ago",AboutAnHourAgo:"about an hour ago",AboutAWeekAgo:"about a week ago","last Friday":"last Friday","last Monday":"last Monday","last Saturday":"last Saturday","last Sunday":"last Sunday","last Thursday":"last Thursday","last Tuesday":"last Tuesday","last Wednesday":"last Wednesday","on Friday":"on Friday",
"on Monday":"on Monday","on Saturday":"on Saturday","on Sunday":"on Sunday","on Thursday":"on Thursday","on Tuesday":"on Tuesday","on Wednesday":"on Wednesday",OverAYearAgo:"over a year ago",XHoursAgo_2To4:"%1 hours ago",XHoursAgo_EndsIn1Not11:"%1 hours ago",XHoursAgo_EndsIn2To4Not12To14:"%1 hours ago",XHoursAgo_Other:"%1 hours ago",XMinutesAgo_2To4:"%1 minutes ago",XMinutesAgo_EndsIn1Not11:"%1 minutes ago",XMinutesAgo_EndsIn2To4Not12To14:"%1 minutes ago",XMinutesAgo_Other:"%1 minutes ago",XMonthsAgo_2To4:"%1 months ago",
XMonthsAgo_5To12:"%1 months ago",XSecondsAgo_2To4:"%1 seconds ago",XSecondsAgo_EndsIn1Not11:"%1 seconds ago",XSecondsAgo_EndsIn2To4Not12To14:"%1 seconds ago",XSecondsAgo_Other:"%1 seconds ago",XWeeksAgo_2To4:"%1 weeks ago"};S("Components.Vim.DateTime")[1](3,"String",function(f){return a(c,f,Array.prototype.slice.call(arguments,1))})})();BotanJS.define("Components.Vim.DateTime");
(function(){function a(a,e){var d=a%10,g=a%100;if(1>=a)throw Error("Invalid number of Time units");return 2<=a&&4>=a?f(e[0],a):1==d&&11!=g?f(e[1],a):2<=d&&4>=d&&!(12<=g&&14>=g)?f(e[2],a):f(e[3],a)}var c=S("Components.Vim.DateTime"),f=c[0]("String"),n=["XHoursAgo_2To4","XHoursAgo_EndsIn1Not11","XHoursAgo_EndsIn2To4Not12To14","XHoursAgo_Other"],h=["XMinutesAgo_2To4","XMinutesAgo_EndsIn1Not11","XMinutesAgo_EndsIn2To4Not12To14","XMinutesAgo_Other"],e=["XSecondsAgo_2To4","XSecondsAgo_EndsIn1Not11","XSecondsAgo_EndsIn2To4Not12To14",
"XSecondsAgo_Other"];c[1](3,"RelativeTime",function(b){var m=Math.round(.001*((new Date).getTime()-b.getTime()));if(31536E3<m)result=f("OverAYearAgo");else if(3952800<m)if(b=Math.round((m+1317600)/2635200),2<=b&&4>=b)result=f("XMonthsAgo_2To4",b);else if(5<=b&&12>=b)result=f("XMonthsAgo_5To12",b);else throw Error("Invalid number of Months");else if(2116800<=m)result=f("AboutAMonthAgo");else if(604800<=m)b=Math.round(m/604800),result=1<b?f("XWeeksAgo_2To4",b):f("AboutAWeekAgo");else{if(432E3<=m)switch(b.getDay()){case 1:b=
f("last Monday");break;case 2:b=f("last Tuesday");break;case 3:b=f("last Wednesday");break;case 4:b=f("last Thursday");break;case 5:b=f("last Friday");break;case 6:b=f("last Saturday");break;case 0:b=f("last Sunday");break;default:b=f("last Sunday")}else if(86400<=m)switch(b.getDay()){case 1:b=f("on Monday");break;case 2:b=f("on Tuesday");break;case 3:b=f("on Wednesday");break;case 4:b=f("on Thursday");break;case 5:b=f("on Friday");break;case 6:b=f("on Saturday");break;case 0:b=f("on Sunday");break;
default:b=f("on Sunday")}else b=7200<=m?a(Math.round(m/3600),n):3600<=m?f("AboutAnHourAgo"):120<=m?a(Math.round(m/60),h):60<=m?f("AboutAMinuteAgo"):a(1<m?m:2,e);result=b}return result})})();BotanJS.define("Components.Vim.State.Stack");
(function(){function a(){}var c=S("Components.Vim.State"),f=U("Components.Vim.DateTime.RelativeTime");a.prototype.store=function(a){this.Ba=a;this.mb=new Date;this.id=0};a.prototype.play=function(){this.Ba&&this.Ba()};s(a.prototype,"time",function(){return f(this.mb)});c[1](2,"Stack",a)})();BotanJS.define("Components.Vim.Actions.FIND");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}function c(a){for(var e="",d=a.length,g=1;g<d;g++)switch(a[g]){case "^I":e+="\t";break;case "\\":var k=a[++g];if(-1!="nrts.[]()^".indexOf(k))e+="\\"+k;else throw Error('Missing token impl: "'+k+'"');break;default:e+=a[g]}return new RegExp("("+e+")","gm")}var f=S("Components.Vim.Actions");U("System.Debug");var n=U("Components.Vim.Error"),h=U("Components.Vim.Message"),e=[];a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=
function(a,m){a.preventDefault();if(m){if(2>m.length){if(1>e.length)return this.b=n("E35"),!0;m=e}e=m}if(1>e.length)return this.b=n("E35"),!0;var d;try{d=c(e)}catch(g){return this.b=n("EX1",g.message),!0}var k=this.a.feeder.content,f=this.a;m=f.aPos;for(var p,v,u,t=[],x;null!==(p=d.exec(k));){void 0==u&&(u=p.index);if(x==p.index)return this.b=n("EX2",e.slice(1).join("")),!0;if(m<p.index){v=p.index;break}t.push(p.index);x=p.index}this.b=e.join("");if(a.kMap("N")){if(v=t[t.length-2],void 0==v)for(this.b=
h("SEARCH_HIT_TOP");null!==(p=d.exec(k));)v=p.index}else void 0!=u&&void 0==v&&(v=u,this.b=h("SEARCH_HIT_BOTTOM"));void 0==v?this.b=n("E486",e.slice(1).join("")):f.moveTo(v)};a.prototype.getMessage=function(){return this.b};D(a,"Pattern",c);f[1](2,"FIND",a)})();BotanJS.define("Components.Vim.Actions.REPLACE");
(function(){function a(a){this.a=a;this.B=this.b="";this.La=0;this.ma=this.ma.bind(this);this.ka=0;this.na=[];a.suppressEvent()}function c(a){for(var b="",e=a.length,m=[""],p=1;p<e;p++)switch(a[p]){case "^I":b+="\t";break;case "\\":p++;var f=a[p];if(-1!="$nrt\\".indexOf(f)){b+=JSON.parse('"\\'+f+'"');break}if(-1!="012345678".indexOf(f))m.push(b.length),b+=f;else{if("9"==f)throw Error("Back ref 9 is reserved for back ref 0");throw Error('Missing token impl: "'+tok+'"');}break;default:b+=a[p]}m[0]=
b;return m}var f=S("Components.Vim.Actions"),n=U("System.Debug"),h=U("Components.Vim.State.Stack"),e=U("Components.Vim.Error"),b=U("Components.Vim.Message");U("System.utils.Perf.CountSubstr");var m=f[0]("FIND");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,g){a.preventDefault();var k,f;try{var p=g.indexOf("/",0),h=g.indexOf("/",p+1);if(-1==p)return this.b=e("MISSING_FEATURE","REPLACE %s"),!0;if(-1==h)k=m.Pattern(g),f=g;else{f=g.slice(p,h);k=m.Pattern(f);var u=
g.indexOf("/",h+1);this.B=-1==u?c(g.slice(h)):c(g.slice(h,u));this.La=this.B[0].length}}catch(t){return this.b=e("EX1",t.message),!0}n.Info("Replace: "+k+", [ "+this.B+" ]");p=this.a.feeder;k=p.content.slice(0,-1).replace(k,this.ma)+"\n";h=this.na.length;h||(this.b=e("E486",f.join("")));p.content=k;this.b=b("REPLACE",h,"<TODO>");this.A();p.pan();p.softReset();return!0};a.prototype.ma=function(){for(var a=arguments[0],b=Array.prototype.slice.call(arguments,1,-2),e=this.ka+arguments[arguments.length-
2],m="",p=this.B[0],f=0;f<this.La;f++)var n=this.B.indexOf(f,1),m=-1==n?m+p[f]:m+b[p[this.B[n]]];b=m.length;this.ka+=b-a.length;p=[];p[0]=a;p[1]=e;p[2]=b;this.na.push(p);return m};a.prototype.A=function(){var a=new h,b=this.na,e=b.length,m=this.a,p=m.feeder;a.store(function(){for(var a=p.content,d="",f=0,n=-1,h=0;h<e;h++){var c=b[h],r=c[1],C=c[2],E=c[0],G=E.length,d=d+(a.substring(f,r)+E),f=c[1]+C;c[0]=a.substr(r,C);c[1]=d.length-G;c[2]=G;-1==n&&(n=r)}d+=a.substring(f);p.content=d;m.moveTo(n);p.pan()});
m.rec.record(a)};a.prototype.getMessage=function(){return this.b};f[1](2,"REPLACE",a)})();BotanJS.define("Components.Vim.Actions.YANK");
(function(){function a(a){this.a=a;this.h=a.aPos;this.b="";a.suppressEvent()}var c=S("Components.Vim.Actions");U("System.Debug");var f=U("Components.Vim.Message"),n=U("Components.Vim.Beep"),h=U("System.utils.Perf.CountSubstr");a.prototype.allowMovement=!0;a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,b,m){a.preventDefault();if(!a.ModKeys&&!a.kMap("i")){var d=a.target.Q,g=this.a,k=!1;if(void 0==b){k=!0;b=this.h;var c=g.aPos;if(this.h!=c)a.kMap("^")?b--:a.kMap("l")?
g.moveX(-1):a.kMap("h")?b=c:a.kMap("j")?(m=!0,g.lineEnd(!0),b=g.aPos,g.moveY(-1),g.lineStart(),this.h=g.aPos):a.kMap("k")?(m=!0,g.moveY(1),g.lineEnd(!0),b=g.aPos,g.moveY(-1),g.lineStart()):this.h<c&&(b=c,g.moveTo(this.h));else if(a.kMap("y"))m=!0,g.lineEnd(!0),b=g.aPos,g.lineStart();else if(a.range)b=a.range.close,g.moveTo(a.range.open,!0);else{if(a.kMap("^"))return!0;if(a.kMap("$"))b=g.aPos;else return n(),!0}}c=b;a=g.aPos;a<c&&(c=g.aPos,a=b);g.moveTo(c);a=g.feeder.content.substring(c,a+1);d.yank(a,
m);if(m=h(a,"\n"))this.b=f("LINES_YANKED",m);return k}};a.prototype.getMessage=function(){return this.b};c[1](2,"YANK",a)})();BotanJS.define("Components.Vim.State.Stator");
(function(){function a(a,n){this.a=a;this.hb=void 0==n?a.aPos:n;this.ib=this.Na()}var c=S("Components.Vim.State");a.prototype.save=function(a,n,h){void 0==h&&(h=0);var e=this.a,b=e.feeder,m=this.hb-h,d=this.ib,g=this.Na(),k=d;return function(){var h=b.content.substr(m,a);b.content=b.content.substring(0,m)+n+b.content.substring(m+a);a=n.length;n=h;e.PStart=k.c;e.PEnd=k.c+1;e.X=k.x;e.Y=k.y;e.pX=k.pb-1;b.panX=k.sb;b.panY=k.tb;b.pan();k=k==d?g:d}};a.prototype.Na=function(){var a=this.a,a={c:a.PStart,
x:a.X,y:a.Y,pb:a.pX,sb:a.feeder.panX,tb:a.feeder.panY};0<a.x&&(--a.c,--a.x);return a};c[1](2,"Stator",a)})();BotanJS.define("Components.Vim.Actions.DELETE");
(function(){function a(a){this.a=a;this.ja=0;this.h=a.aPos;this.Ia=this.a.feeder.panY;a.suppressEvent()}var c=S("Components.Vim.Actions"),f=U("System.Debug"),n=U("Components.Vim.State.Stator"),h=U("Components.Vim.State.Stack"),e=U("Components.Vim.Message"),b=U("Components.Vim.Beep"),m=U("System.utils.Perf.CountSubstr");a.prototype.allowMovement=!0;a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,g,k){a.preventDefault();if(!a.ModKeys){var e=a.target.Q,p=this.a,
c=p.feeder;if(c.firstBuffer.next.placeholder&&2>c.content.length)return f.Info("Content is empty"),!0;var u=!1;if(void 0==g){u=!0;g=this.h;var t=p.aPos;if(this.h!=t)a.kMap("^")?g--:a.kMap("l")?p.moveX(-1):a.kMap("h")?g=t:a.kMap("j")?(k=!0,p.lineEnd(!0),g=p.aPos,p.moveY(-1),p.lineStart(),this.h=p.aPos):a.kMap("k")?(k=!0,p.moveY(1),p.lineEnd(!0),g=p.aPos,p.moveY(-1),p.lineStart()):this.h<t&&(g=t,p.moveTo(this.h));else if(a.kMap("d"))k=!0,p.lineEnd(!0),g=p.aPos,p.lineStart();else if(a.range)g=a.range.close,
p.moveTo(a.range.open,!0);else{if(a.kMap("^"))return!0;if(a.kMap("$"))g=p.aPos;else return b(),!0}}var t=c.content.slice(0,-1),x=g;a=p.aPos;a<x&&(x=p.aPos,a=g);g=t.substring(x,a+1);e.change(g,k);this.ja=m(g,"\n");c.content=t.substring(0,x)+t.substring(a+1)+"\n";c.pan(void 0,this.Ia<c.panY?this.Ia-c.panY:void 0);p.moveTo(x);a=new n(p,x);k=new h;var A=a.save(0,g);k.store(function(){A();p.moveX(1)});p.rec.record(k);return u}};a.prototype.getMessage=function(){return this.ja?e("LINES_FEWER",this.ja):
""};c[1](2,"DELETE",a)})();BotanJS.define("Components.Vim.Actions.SHIFT_LINES");
(function(){function a(a,b){this.a=a;this.h=a.aPos;this.b="<LINE_SHIFT>";this.Qa=a.e().lineNum;this.Fa=b.count;f.Info("Open shift: "+this.Fa+" line(s) below the cursor");this.za=b.kMap(">")?1:-1;f.Info("Direction is: "+(1==this.za?">":"<"));a.suppressEvent()}var c=S("Components.Vim.Actions"),f=U("System.Debug"),n=U("Components.Vim.Beep"),h=U("Components.Vim.State.Stator"),e=U("Components.Vim.State.Stack");U("Components.Vim.Error");var b=U("Components.Vim.Message"),m=U("System.utils.Perf.CountSubstr");
a.prototype.allowMovement=!0;a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,g){a.preventDefault();if(!a.ModKeys&&!a.kMap("i")){var k=this.a,c=k.feeder,p=!1,v=this.za,u=this.Qa,t=this.Fa,x=1;1<a.count&&(t+=a.count);var A=u;if(void 0==g){p=!0;g=this.h;var z=k.aPos;if(this.h!=z){z<g&&(g+=z,z=g-z,g-=z);for(var r=u=A=0;r<z;r++)"\n"==c.content[r]&&(A++,r<g&&u++)}else if(a.range){g=a.range.close;u=1;A=-1;for(r=0;r<g;r++)"\n"==c.content[r]&&(A++,r<a.range.open&&u++);
-1==A&&(u=A=0);A<u&&(A=--u);x=a.count}else if(!(0<v&&(a.kMap(">")||a.kMap("l"))||0>v&&(a.kMap("<")||a.kMap("h"))))return n(),!0}else{for(r=u=0;r<g;r++)"\n"==c.content[r]&&u++;A=this.Qa;x=a.count}A<u&&(u+=A,A=u-A,u-=A);var z=c.content.slice(0,-1),C=z.match(/^[\t ]+/gm),E="\t",G=c.firstBuffer.tabWidth;if(C){var H=C.length-1;if(1<H){f.Info("Guessing the tabstop:");for(var F=t=0,G=[],r=0;r<H;r++){var y=C[r],B=C[r+1],t=t+m(y,"\t"),F=F+m(y," "),y=B.length-y.length;0!=y&&(y=0>y?-y:y,G[y]||(G[y]=0),G[y]++)}H=
C=0;for(r in G)r=Number(r),y=G[r],C<y&&(C=y,H=r);F/=H;if(t<F)for(E="",r=0;r<H;r++)E+=" ";G=H;f.Info("\tTab count: "+t);f.Info("\tSpace count: "+F);f.Info("\ti.e. indent using "+JSON.stringify(E))}else f.Info("Not enough tabs to determine the tabstop, using default")}f.Info("Start: "+u,"End: "+A);var F="",C=0,H=!1,I=0;c.content="";t=0;y="";for(r=0;r<x;r++)y+=E;for(E=r=0;0<=r;r=z.indexOf("\n",r),E++)if(r++,!(E<u)){H||(H=!0,c.content=z.substring(0,r-1),I=c.content.length);if(A<E)break;B=z.indexOf("\n",
r);B=~B?z.substring(1<r?r:r-1,B):z.substring(1<r?r:r-1);1<r&&(c.content+="\n",F+="\n",C++);F+=B;if(""!==B){if(0<v)B=y+B;else{for(var T=0,J=0;T<x;T++){var P=B[J];if(" "==P)for(P=G+J++;J<P&&~"\t ".indexOf(B[J]);J++);else if("\t"==P)J++;else break}B=B.substring(J)}c.content+=B;C+=B.length;t++}}u=c.content.length;c.content+="\n";~r&&(c.content+=z.substring(r)+"\n");c.pan();k.moveTo(u);r=new h(k,I);u=new e;for(I++;~"\t ".indexOf(c.content[I]);I++);var V=r.save(C,F);u.store(function(){V();k.moveTo(I);k.lineStart()});
k.moveTo(I);k.rec.record(u);this.b=t?b("LINES_SHIFTED",t,0>v?"<":">",x):b("NO_SHIFT",0>v?"<":">");return p}};a.prototype.getMessage=function(){return this.b};c[1](2,"SHIFT_LINES",a)})();BotanJS.define("Components.Vim.Actions.VISUAL");
(function(){function a(a){this.Ma(a);this.b="";a.blink=!1;a.pSpace=!0}function c(a,b){if(0==b)return 0;for(var k=a.feeder,e=0,m=-1,f=k.content.indexOf("\n");0<=f&&!(m=f,e++,b<=e);f=k.content.indexOf("\n",f+1));k.EOF&&(f=m);k=k.content[f+1];void 0!=k&&"\n"!=k&&f++;return f}var f=S("Components.Vim.Actions"),n=U("System.Debug"),h=U("Components.Vim.Message"),e=f[0]("YANK"),b=f[0]("DELETE"),m=f[0]("SHIFT_LINES");a.prototype.Ma=function(a){this.a=a;var b={lineNum:a.e().lineNum,X:a.X,aPos:a.aPos,rb:a.PStart};
b.ob=b.aPos-a.aX;a.suppressEvent();a.lineEnd(!0);b.nb=a.aPos;a.moveTo(b.aPos);a.unsuppressEvent();this.Ra=b};a.prototype.allowMovement=!0;a.prototype.dispose=function(){var a=this.a;a.blink=!0;a.pSpace=!1;a.updatePosition();a.feeder.wrap&&0<a.X&&(a.suppressEvent(),a.moveX(-1),a.moveX(1),a.unsuppressEvent())};a.prototype.handler=function(a){a.preventDefault();if(!a.ModKeys){var g=this.a,k=g.feeder,f=null,p=!1;if(a.kMap("y"))f=new e(g);else if(a.kMap("d"))f=new b(g);else if(a.kMap("V")){if(1==this.n)return!0;
p=!0;this.n=1;this.b=h("VISLINE")}else if(a.kMap("<")||a.kMap(">"))f=new m(g,a);else if(a.kMap("v")){if(0==this.n)return!0;p=!0;this.n=0;this.b=h("VISUAL");g.updatePosition()}p&&k.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"));if(-1==this.n)return n.Error(Error("Mode is undefined")),!0;p=this.Ra;if(f){g.suppressEvent();if(k=1==this.n)p.aPos<g.aPos?(g.lineEnd(!0),p.aPos=p.ob):(g.lineStart(),p.aPos=p.nb);if(f.constructor==b&&p.aPos<g.aPos){var v=g.aPos;g.moveTo(p.aPos,!0);p.aPos=v}f.handler(a,
p.aPos,k);f.constructor!=b&&g.moveTo(p.aPos);this.b=f.getMessage();f.dispose();g.unsuppressEvent();p.rb=g.PStart;return!0}a.range&&(g.suppressEvent(),a=a.range,g.aPos==p.aPos&&(g.moveTo(a.open,!0),this.Ma(g),p=this.Ra),g.unsuppressEvent(),g.moveTo(a.close,!0));var u=g.aPos,f=k.firstBuffer;a=f.lineNum;var t=c(g,a),x=c(g,a+k.moreAt+1)-1;n.Info("Min aPos: "+t,"Max aPos: "+x);a=p.X;v=g.PStart;if(p.aPos<t)a=0,1==this.n&&(g.suppressEvent(),g.lineEnd(!0),v=g.PStart,g.moveTo(u,!0),g.unsuppressEvent());else if(x<
p.aPos){a=-2;p=0;do{if(f.placeholder)break;p<=k.moreAt&&(a+=f.toString().length+1);p++}while(f=f.next)}else{k=p.lineNum;if(1==this.n)g.suppressEvent(),a=0,u<p.aPos?(a=-1,k++,g.lineStart(),v=g.PStart):p.aPos<u?(g.lineEnd(!0),v=g.PStart):(g.lineStart(),v=g.PStart,g.lineEnd(!0),a=g.PStart,k=f.lineNum),g.moveTo(u,!0),g.unsuppressEvent();else if(0==this.n&&u==p.aPos)return;do{if(f.lineNum==k||f.placeholder)break;a+=f.toString().length+1}while(f=f.next)}p=a;k=v;f=k-p;0<=f?k+=1:0>f&&(p+=f,k=a+1);g.PStart=
p;g.PEnd=k}};a.prototype.getMessage=function(){return this.b};f[1](2,"VISUAL",a)})();BotanJS.define("Components.Vim.Actions.JOIN_LINES");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var c=S("Components.Vim.Actions");U("System.Debug");var f=U("Components.Vim.State.Stator"),n=U("Components.Vim.State.Stack"),h=U("Components.Vim.Beep");U("Components.Vim.Message");U("System.utils.Perf.CountSubstr");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,b){a.preventDefault();var m=this.a,d=m.feeder,g,k,c,p;if(b)g=b.start;else{p=m.aPos;m.lineEnd(!0);c=new f(m);g=m.aPos;m.moveY(1);m.lineStart();
k=m.aPos;if(k<g)return m.moveTo(p),h(),!0;var v=d.content;p=d.content.substring(g,k);d.content=v.substring(0,g)+" "+v.substr(k)}d.pan();m.moveTo(g);d=new n;d.store(c.save(1,p));m.rec.record(d)};a.prototype.getMessage=function(){return this.b};c[1](2,"JOIN_LINES",a)})();BotanJS.define("Components.Vim.Actions.EDITOR_COMMAND");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var c=S("Components.Vim.Actions"),f=U("System.Debug"),n=U("Components.Vim.Error");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,e){a.preventDefault();var b=1,m="",d=[];if(-1!=".$%".indexOf(e[b]))m=e[b++];else for(;-1!="0123456789".indexOf(e[b]);b++)m+=e[b];var g="";if(-1!="/?".indexOf(e[b]))g=e[b];else for(var k=/\w/g,M=e[b];M=e[b];b++)if(M.match(k))g+=M;else break;k=!1;switch(g){case "s":case "su":case "substitute":k=
!0;d[1]="REPLACE";break;case "/":k=!0;d[1]="FIND";break;case "buffers":case "ls":d[1]="BUFFERS";break;case "w":case "write":d[1]="WRITE";break;case "q":case "quit":d[1]="QUIT";break;case "register":case "registers":d[1]="REGISTERS";break;case "ver":case "version":d[1]="VERSION";break;case "h":case "help":d[1]="HELP"}""!==m&&(k?d[0]=m:d[3]=n("E481"));d[2]=e.slice(b);if(d[3])return this.b=d[3],!0;if(!d[1])return this.b=n("E492",e.slice(1).join("")),!0;try{c[0](d[1])}catch(p){return this.b=n("TODO",
d[1]),!0}try{this.a.openRunAction(d[1],a,d[2],d[0]),this.b=this.a.message}catch(v){f.Error(v)}return!0};a.prototype.getMessage=function(){return this.b};c[1](2,"EDITOR_COMMAND",a)})();BotanJS.define("Components.Vim.Actions.TO");
(function(){function a(a){this.a=a;this.b="<TO COMMAND>";a.suppressEvent()}var c=S("Components.Vim.Actions");U("System.Debug");var f=U("Components.Vim.Beep");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a,h){h.preventDefault();var e=this.a,b=e.feeder,m=e.e().lineNum,d=0;for(i=0;-1!=d&&i<m;i++)d=b.content.indexOf("\n",d+1);var g=b.content.indexOf("\n",d+1);0<m&&d++;m=d;d=h.key;h.kMap("Tab")&&(d="\t");if(1<d.length)f();else{var k=-1,k=a.kMap("t")||a.kMap("f")?
b.content.indexOf(d,e.aPos+1):b.content.lastIndexOf(d,e.aPos-1);m<=k&&k<g?e.moveTo(k):f()}};a.prototype.getMessage=function(){return this.b};c[1](2,"TO",a)})();BotanJS.define("Components.Vim.Actions.QUIT");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var c=S("Components.Vim.Actions");U("System.Debug");var f=U("Components.Vim.Error");U("System.utils.Perf.CountSubstr");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();a=this.a;var h=a.Vim;if(a.rec.changed){a=f("E37");for(var h=this.a.feeder.firstBuffer.cols,e=a.length;e<h;e++)a+=" ";this.b=a}else return h.dispose(),!0};a.prototype.getMessage=function(){return this.b};c[1](2,"QUIT",
a)})();BotanJS.define("Components.Vim.Actions.BUFFERS");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var c=S("Components.Vim.Actions");U("System.Debug");var f=U("Dandelion"),n=U("Components.Vim.Message");U("System.utils.Perf.CountSubstr");var h=U;a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();f.tag("textarea");var b=this.a.Vim,m=h("Components.Vim.VimArea").Instances;a=":buffers";for(var d in m){var g=m[d],k=g.index+" ",c=g.contentFeeder.cursor,k=k+((g==b?"%a":"  ")+" "),k=k+
((c.rec.changed?"+":" ")+" "),k=k+('"'+g.stage.element.id+'" line '+(c.e().lineNum+1));a+="\n  "+k}b=n("WAIT_FOR_INPUT");m=this.a.feeder.firstBuffer.cols;for(d=a.length;d<m;d++)a+=" ";this.b=a+"\n"+b};a.prototype.getMessage=function(){return this.b};c[1](2,"BUFFERS",a)})();BotanJS.define("Components.Vim.Actions.UNDO");
(function(){function a(a){this.a=a;this.t="UNDO COMMAND"}var c=S("Components.Vim.Actions"),f=U("Components.Vim.Message");a.prototype.dispose=function(){};a.prototype.handler=function(a){a.preventDefault();(a=this.a.rec.undo())?(this.a.suppressEvent(),a.play(),this.a.unsuppressEvent(),this.t=f("NCHANGES","<TODO>",a.id,a.time)):this.t=f("UNDO_LIMIT")};a.prototype.getMessage=function(){return this.t};c[1](2,"UNDO",a)})();BotanJS.define("Components.Vim.Actions.REGISTERS");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var c=S("Components.Vim.Actions");U("System.Debug");U("Components.Vim.Error");var f=U("Components.Vim.Message");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();var c=a.target.Q;a=":register\n"+f("REGISTERS");for(var e=0,b='"0123456789abcdefghijklmnopqrstuvwxyz-.:%/='[e];void 0!=b;e++,b='"0123456789abcdefghijklmnopqrstuvwxyz-.:%/='[e]){var m=c.get(b);m&&(a+='\n"'+b+"   "+m.toString().replace("\t",
"^I").replace("\n","^J"))}c=f("WAIT_FOR_INPUT");b=this.a.feeder.firstBuffer.cols;for(e=a.length;e<b;e++)a+=" ";this.b=a+"\n"+c};a.prototype.getMessage=function(){return this.b};c[1](2,"REGISTERS",a)})();BotanJS.define("Components.Vim.Actions.PRINT_HEX");
(function(){function a(a){this.a=a}var c=S("Components.Vim.Actions");U("System.Debug");a.prototype.dispose=function(){};a.prototype.handler=function(a){a.preventDefault();a=unescape(encodeURIComponent(this.a.feeder.content[this.a.aPos]));for(var c=a.length,h=[],e=0;e<c;e++)h[e]="\n"==a[e]?"a":a.charCodeAt(e).toString(16),1==h[e].length?h[e]="0"+h[e]:0==h[e].length&&(h[e]="00");this.b=h.join(" ")};a.prototype.getMessage=function(){return this.b};c[1](2,"PRINT_HEX",a)})();BotanJS.define("Components.Vim.Actions.WORD");
(function(){function a(a){this.a=a;this.b="<WORD COMMAND>";a.suppressEvent()}var c=S("Components.Vim.Actions");U("System.Debug");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();var c=this.a,h=c.feeder,e=c.Vim.contentAnalyzer,b=c.aPos,m=1;if(a.kMap("w")||a.kMap("W")){"\n"==h.content[b+1]&&b++;var d=e.wordAt(b);-1!=d.open&&(b=d.close+1)}if(a.kMap("b")||a.kMap("B")){if(0==b)return;m=-1;d=e.wordAt(b-1);-1!=d.open&&(b=d.open)}for(;-1!=" \t".indexOf(h.content[b]);)b+=
m;c.moveTo(b)};a.prototype.getMessage=function(){return this.b};c[1](2,"WORD",a)})();BotanJS.define("Components.Vim.Actions.VERSION");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var c=S("Components.Vim.Actions");U("System.Debug");U("Components.Vim.Error");var f=U("Components.Vim.Message");a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();a=":version\nVim;Re - Vim; Reverse Engineered for textarea v"+VIMRE_VERSION;a+="\n  + BotanJS - v1.0.0b\nProject home - https://github.com/tgckpg/BotanJS-vim";a+="\n  by \u659f\u914c\u9d6c\u5144 (penguin) - https://blog.astropenguin.net/";
a+="\n";for(var c=f("WAIT_FOR_INPUT"),e=this.a.feeder.firstBuffer.cols,b=a.length;b<e;b++)a+=" ";this.b=a+"\n"+c};a.prototype.getMessage=function(){return this.b};c[1](2,"VERSION",a)})();BotanJS.define("Components.Vim.Actions.REDO");
(function(){function a(a){this.a=a;this.t="REDO COMMAND"}var c=S("Components.Vim.Actions"),f=U("Components.Vim.Message");a.prototype.dispose=function(){};a.prototype.handler=function(a){a.preventDefault();(a=this.a.rec.redo())?(this.a.suppressEvent(),a.play(),this.a.unsuppressEvent(),this.t=f("NCHANGES","<TODO>",a.id,a.time)):this.t=f("REDO_LIMIT")};a.prototype.getMessage=function(){return this.t};c[1](2,"REDO",a)})();BotanJS.define("Components.Vim.Actions.PUT");
(function(){function a(a){this.a=a;this.b="";a.suppressEvent()}var c=S("Components.Vim.Actions"),f=U("Components.Vim.State.Stator"),n=U("Components.Vim.State.Stack"),h=U("Components.Vim.Message"),e=U("System.utils.Perf.CountSubstr");a.prototype.allowMovement=!1;a.prototype.dispose=function(){this.a.unsuppressEvent()};a.prototype.handler=function(a){a.preventDefault();var m=this.a.Vim.Q.get();if(!m)return!0;var d=this.a,g=d.feeder,k=m.newLine;if(1<a.count){for(var c=m,p=1;p<a.count;p++)c+=m;m=c;c=
null}var c=e(m,"\n"),p=m.length,v=a.kMap("P")?0:-1;k&&(d.moveY(-v),d.lineStart());a=new f(d);var u=d.aPos;g.content=g.content.substring(0,u)+m+g.content.substring(u);g.pan();d.moveTo(0<c?u:u+p,!0);m=new n;if(k){var t=a.save(p,"");m.store(function(){t();d.moveY(v)})}else m.store(a.save(p,""));d.rec.record(m);c&&(this.b=h("LINES_MORE",c));d.moveX(-1);return!0};a.prototype.getMessage=function(){return this.b};c[1](2,"PUT",a)})();BotanJS.define("Components.Vim.Actions.INSERT");
(function(){function a(a){this.a=a;this.jb=new n(a);this.v=this.u=0;this.A("",!0);a=this.a.feeder.firstBuffer.cols;for(var m=e("INSERT"),d=m.length;d<a;d++)m+=" ";this.b=m}var c=S("Components.Vim.Actions"),f=U("Components.Vim.State.Stack"),n=U("Components.Vim.State.Stator"),h=U("System.Debug"),e=U("Components.Vim.Message");a.prototype.allowMovement=!1;a.prototype.dispose=function(){this.ua()&&this.a.feeder.pan();this.b="";this.A("",!0);this.a.moveX(-1)};a.prototype.A=function(a,e){if(e||!this.ca){if(this.ca){if(0==
this.u&&0==this.p&&""===this.s)return;this.p<this.u&&(this.u=this.p);this.ca.store(this.jb.save(this.v,this.s,-this.u));this.a.rec.record(this.ca)}this.p=0;this.s="";this.ca=new f}this.p<this.u&&(this.v=0,this.u=this.p);this.p+=a.length;this.v+=a.length};a.prototype.fb=function(a){var e=this.a,d=e.feeder;if(a.kMap("BS")||a.kMap("S-BS")){this.la();if(0==e.X&&0==d.panY&&0==e.Y)return;a=e.aPos-1;this.p<=this.u&&(this.s=d.content.substr(a,1)+this.s);d.content=d.content.substring(0,a)+d.content.substring(a+
1);d.pan();e.moveX(-1,!0,!0);0<this.v&&this.v--;this.p--}else if(a.kMap("Del")||a.kMap("S-Del"))this.la(),a=e.aPos,this.s+=d.content.substr(a,1),d.content=d.content.substring(0,a)+d.content.substring(a+1),d.pan();else return;d.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))};a.prototype.handler=function(a){a.preventDefault();if(!a.ModKeys){var e;a:switch(e=a.key,e){case "Tab":e="\t";break a;case "Enter":e="\n";break a}if(1!=e.length)this.fb(a);else{a=this.a;var d=a.feeder,g=a.aPos;d.content=
d.content.substring(0,g)+e+d.content.substring(g);"\n"==e?(d.softReset(),d.pan(),a.moveY(1),a.lineStart(),this.Ya()):(this.la(),d.pan(),a.moveX(1,!1,!0));d.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"));this.A(e)}}};a.prototype.la=function(){var a=this.J;if(this.J){h.Info("Realize Indentation: "+a);l=a[1];for(var e=a[0];e<l;e++)this.A(this.a.feeder.content[e]);this.s=a[2]+this.s;this.J=null}};a.prototype.Ya=function(){for(var a=this.ua(),e=this.a,d=e.feeder,g=e.aPos,k=d.content.lastIndexOf("\n",
g-2),f=d.content.substring(k+1,g-1)||a;""==f&&0<k;)a=k,k=d.content.lastIndexOf("\n",a-2),f=d.content.substring(k+1,a-1);for(var a="",p=g;-1!="\t ".indexOf(d.content[p]);p++)a+=d.content[p];for(k=0;-1!="\t ".indexOf(f[k]);k++);f&&(d.content=d.content.substring(0,g)+f.substr(0,k)+d.content.substring(p),d.softReset(),d.pan(),e.moveX(k,!1,!0),e=[],e[0]=g,e[1]=g+k,e[2]=a,this.J=e,h.Info("Phantom indent: "+e))};a.prototype.ua=function(){var a=this.J;if(!a)return"";h.Info("Erase phantom indent: "+a);var e=
this.a.feeder,d=e.content.substring(a[0],a[1]);e.content=e.content.substring(0,a[0])+e.content.substring(a[1]);this.J=null;return d};a.prototype.getMessage=function(){return this.b};c[1](2,"INSERT",a)})();BotanJS.define("Components.Vim.Cursor");
(function(){function a(a){this.feeder=a;this.cols=a.firstBuffer.cols;this.PStart=this.Y=this.X=this.pX=0;this.PEnd=1;this.rec=new h;this.action=null;this.blink=!0;this.pSpace=!1;this.I=this.da=0}function c(a,e){var d=a.e(),g=a.Y+e,k=a.Y;d||(d=a.feeder.firstBuffer,k=0,g=e);for(d!=a.feeder.firstBuffer&&k--;k<g&&!d.placeholder;d=d.nextLine)d.br&&k++;return k}var f=S("Components.Vim"),n=U("System.Debug"),h=U("Components.Vim.State.Recorder"),e=U("Components.Vim.Actions.*");a.prototype.Vim;a.prototype.moveTo=
function(a,e){var d=this.feeder.content,g=this.e(),k=g.lineNum;g.placeholder&&(this.Y=k=0);for(var f=0,p=0,c=d.indexOf("\n");0<=c&&!(a<=c);c=d.indexOf("\n",c))p=c,c++,f++;d=f-k;k=a<p?p-a:a-p;k+=Math.ceil(k/g.cols)-1;d&&this.moveY(d);0<this.e().lineNum&&p<=a&&k--;this.moveX(-Number.MAX_VALUE);this.moveX(k,!1,e)};a.prototype.moveX=function(a,e,d){var g=this.pX,k=Boolean(a);0<this.I&&(0<a&&d&&(a+=this.I),this.I=0);k&&(g=this.X+a);a||(a=1);var f=this.feeder;if(e&&0>g&&(0<this.feeder.panY||0<this.Y))this.moveY(-1),
this.lineEnd(d);else{var c=this.e(),h=c.visualLines.join("\n");e=h.length;var n=0,t=!0;if(1<e){for(var x=c.lineNum-1,n=f.content,t=n.indexOf("\n"),A=0;0<=t&&x!=A;t=n.indexOf("\n",t),A++)t++;0==A&&-1==t&&(t=0);x=n.indexOf("\n",t+1);x=-1==x?n.length:x;n=(t=0<(x-t-1)%c.cols)?d?e-1:e-2:d?e:e-1}c=h[g];(e=void 0==c||e==g+1&&" "==c)?g=0<g?n:0:"\n"==c&&(g+=a);f.wrap&&e&&!t&&d&&(this.I=1);this.X=g;k&&(this.pX=g,this.updatePosition())}};a.prototype.lineStart=function(){this.pX=0;this.moveX();this.updatePosition()};
a.prototype.lineEnd=function(a){this.moveX(Number.MAX_VALUE,!1,a)};a.prototype.updatePosition=function(){var a=0,e=0,d=this.feeder.lineBuffers[0];a:for(;d&&e<this.Y;e++)for(;d;){if(d.next&&d.next.placeholder)break a;a+=d.toString().length+1;if((d=d.next)&&d.br)break}this.PStart=a=this.X+a+this.I;this.PEnd=a+1;this.C()};a.prototype.C=function(){0<this.da?n.Info("Event suppressed, suppression level is: "+this.da):this.feeder.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))};a.prototype.moveY=
function(a){var e=this.Y+a,d=this.feeder,g;if(0>e)d.pan(void 0,e),this.Y=0,this.moveX(),this.updatePosition(),d.softReset();else if(!d.EOF&&d.moreAt<e){d=this.feeder;if(d.linesTotal<e){for(;!d.EOF;)d.pan(void 0,1);a=c(this,a)}else{g=d.lastBuffer.lineNum;var e=e-d.moreAt,k=this.e().lineNum;d.EOF||d.pan(void 0,e);for(e=k+a;!d.EOF&&(d.lastBuffer.lineNum==g||d.lastBuffer.lineNum<e);)d.pan(void 0,1);this.Y=0;for(g=this.e();g&&g.lineNum!=e&&!g.placeholder;this.Y++,g=this.e());a=this.Y;d.EOF||d.lastBuffer.next.lineNum!=
g.lineNum||a--}this.Y=a;this.moveX();this.updatePosition();d.softReset()}else{if(0<a){g=this.e();if(g.nextLine.placeholder)return;e=c(this,a)}this.Y=e;this.moveX();this.updatePosition()}};a.prototype.openAction=function(a,f){this.action&&this.action.dispose();n.Info("openAction: "+a);this.action=new e[a](this,f);this.w=null;this.C()};a.prototype.closeAction=function(){this.action&&(this.action.dispose(),this.w=this.action.getMessage(),this.action=null,n.Info("closeAction: "+this.w),this.Vim.contentAnalyzer.reset(),
this.C())};a.prototype.openRunAction=function(a,f,d,g,k,c,p){n.Info("OpenRunAction: "+a);a=new e[a](this);a.handler(f,d,g,k,c,p);this.w=a.getMessage();a.dispose();this.Vim.contentAnalyzer.reset();this.C()};a.prototype.suppressEvent=function(){++this.da};a.prototype.unsuppressEvent=function(){--this.da};a.prototype.e=function(){for(var a=this.feeder,e=a.firstBuffer,a=a.lastBuffer.next,d=0;e!=a;e=e.next)if(e.br&&d++,this.Y==d)return e;return null};s(a.prototype,"aX",function(){var a=this.X,e=1;if(this.feeder.wrap){var d=
this.e().visualLines,g;for(g in d){var k=d[g],f=k.content.toString().length,k=k.toString().length,a=a-(k+1);if(0<=a)e+=f;else if(0>a){e+=a+k;break}}}else return this.X;return e});s(a.prototype,"aPos",function(){var a=this.feeder,e=this.e().lineNum,d=0;if(0<e){d=a.content.indexOf("\n");for(i=1;-1!=d&&i<e;i++)d=a.content.indexOf("\n",d+1);a.wrap&&d++}return d+=this.aX});s(a.prototype,"face",function(){return"\u2588"});s(a.prototype,"message",function(){if(this.w){var a=this.w;this.w=null;return a}return this.action&&
this.action.getMessage()});s(a.prototype,"position",function(){return{start:this.PStart,end:this.PEnd}});f[1](2,"Cursor",a)})();BotanJS.define("Components.Vim.LineFeeder");
(function(){function a(a,b){var c=[];c[a]=new f(b);for(var d=a-1;0<=d;d--)c[d]=new f(b,c[d+1]);this.lineBuffers=c;this.panY=this.panX=0;this.wrap=!0;this.setRender();this.cursor=new n(this);this.dispatcher=new K;this.G=null;this.$=-1;this.L=a}var c=S("Components.Vim");U("System.Debug");var f=c[0]("LineBuffer"),n=c[0]("Cursor"),h=U("System.utils.Perf.CountSubstr");a.prototype.init=function(a,b){this.content=a;this.setWrap(b);this.firstBuffer.R(a,this.wrap,0)};a.prototype.setWrap=function(a){void 0!=
a&&(this.wrap=a)};a.prototype.setRender=function(a){void 0==a&&(a=!0);var b=this,f=a?function(){return!0}:function(a){return!a.placeholder};this.cb=function(a,e){for(var k=(void 0==a?"":a)+"",c=!1,p=0;a&&p<e&&(a=a.next)&&f(a);p++)c||a.br&&e<p+a.visualLines.length?(c||(b.G=a),c=!0,k+="\n@"):k+="\n"+a;return k};this.eb=function(){for(var a=b.lineBuffers[b.bb],e=b.Ka+1,k=0;a&&k<e&&(a=a.next)&&f(a);k++)if(a.br&&e<k+a.visualLines.length){b.G=a;break}}};a.prototype.render=function(a,b){var f=this.lineBuffers;
if(void 0==a)a=0;else if(this.L<a)return"";if(void 0==b||this.L-a<b)b=this.rows-a;if(0==b)return"";this.bb=a;this.Ka=b-1;return this.cb(f[a],this.Ka)};a.prototype.pan=function(a,b){void 0==a&&(a=0);void 0==b&&(b=0);var f=this.panX+a,d=this.panY+b,g=-1,k=0;0>d&&(d=0);var c=this.content.slice(0,-1);if(0<d)for(g=c.indexOf("\n"),k=1;-1!=g&&k<d;k++){var p=c.indexOf("\n",g+1);if(-1==p){d=k;break}g=p}this.firstBuffer.R(this.content.substr(g+1),this.wrap,k);this.panX=f;this.panY=d};a.prototype.softReset=
function(){this.$=-1;this.G=null;this.eb()};s(a.prototype,"linesTotal",function(){return h(this.content,"\n")});s(a.prototype,"firstBuffer",function(){return this.lineBuffers[0]});s(a.prototype,"lastBuffer",function(){return this.lineBuffers[this.L-1]});s(a.prototype,"EOF",function(){return this.lineBuffers[this.L].placeholder});s(a.prototype,"moreAt",function(){if(0<this.$)return this.$;var a=this.firstBuffer;if(a.placeholder)return 0;var b=0;do{if(this.G==a)break;a.br&&b++}while(a=a.next);void 0==
a&&b--;return this.$=b});s(a.prototype,"lineStat",function(){var a=this.cursor.aX+1,b=this.cursor.e(),f="",d=b.content.match(/\t/g);d&&(f="-"+(a+d.length*(b.tabWidth-1)));return b.lineNum+1+","+a+f});s(a.prototype,"docPos",function(){var a="ALL";if(0<this.panY)a=this.EOF?"BOTTOM":Math.floor(this.panY/(this.linesTotal-(this.L-1))*100)+"%";else if(this.G||!this.EOF)a="TOP";return a});s(a.prototype,"linesOccupied",function(){var a=this.firstBuffer;if(a.placeholder)return 0;var b=0;do b++;while((a=a.next)&&
!a.placeholder);return b});c[1](2,"LineFeeder",a)})();BotanJS.define("Components.Vim.StatusBar");
(function(){function a(a){this.cols=a;this.qa={};this.override=null}var c=S("Components.Vim");U("System.Debug");c[0]("LineFeeder");a.prototype.stamp=function(a,c){this.qa[a]=c};a.prototype.override;s(a.prototype,"statusText",function(){if(this.override)return this.override();for(var a="",c=this.cols,h=0;h<c;h++){var e=c-h,b=this.qa[h]||this.qa[-e];if(b){if(b=b(),void 0!=b&&""!==b){if(0==h&&c<=b.length)return b;a+=b.substr(0,e);h=a.length}}else a+=" "}return a});c[1](2,"StatusBar",a)})();BotanJS.define("Components.Vim.State.History");
(function(){function a(a){h[a]||(h[a]=[]);this.q=h[a];this.reset()}function c(a,b){var c=b.length;if(a.length<c)return!1;for(var d=0;d<c;d++)if(a[d]!=b[d])return!1;return!0}var f=S("Components.Vim.State"),n=U("System.Debug"),h={};a.prototype.push=function(a){var b;if(b=this.q.length)a:{b=this.q[this.q.length-1];for(var c=b.length<a.length?a.length:b.length,d=0;d<c;d++)if(b[d]!=a[d]){b=!1;break a}b=!0}b?n.Info("This is the previous command, skipping"):this.q.push(a)};a.prototype.prev=function(a){for(this.q.length<=
this.f&&this.reset();-1<this.f;){var b=this.q[this.f--];if(b&&c(b,a))return b.slice()}return null};a.prototype.next=function(a){0>this.f&&(this.f++,this.next(a));for(;this.f<this.q.length;){var b=this.q[this.f++];if(b&&c(b,a))return b.slice()}return null};a.prototype.reset=function(){this.f=this.q.length-1};f[1](2,"History",a)})();BotanJS.define("Components.Vim.Ex.Command");
(function(){function a(a,e){var g=this;if(!b[e])throw Error("Unsupport mode: "+e);this.a=a;this.Sa=a.Vim.statusBar;this.n=e;this.W=new h(b[e]);this.g=[];this.o=null;this.sa="ExCommandBlinkCycle"+n.uuid;this.j=0;var k=a.feeder,c=!1,p=!1;this.D=function(){p=c=!0};f.perma(this.sa,function(){p?p=!1:c=!c;k.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))},600);this.Za=function(){for(var b="",e=g.g,d=g.j,k=e.length,f=0;f<k;f++){var p=e[f];c&&f==d&&(face=!0,p=a.face+p.substr(1));b+=p}c&&k<=d&&(b+=
a.face);return b};this.Sa.override=this.Za}var c=S("Components.Vim.Ex"),f=U("System.Cycle");U("System.Debug");var n=U("System.utils.Perf"),h=U("Components.Vim.State.History");U("Components.Vim.Message");var e=U("Components.Vim.Beep"),b={"/":n.uuid,":":n.uuid};a.prototype.dispose=function(){this.Sa.override=null;f.permaRemove(this.sa);this.a.feeder.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))};a.prototype.handler=function(a){a.preventDefault();if(!a.ModKeys){this.D();var b=null,g=!1;if(a.kMap("Tab"))b=
"^I";else if(!a.kMap("C-v"))if(a.kMap("BS")){if(1==this.j&&1<this.g.length)return!1;this.g.splice(--this.j,1);if(0==this.g.length)return a.cancel(),!0}else if(a.kMap("Del"))this.g.splice(this.j,1);else{if(a.kMap("Enter"))return this.ab(a),!0;if(a.kMap("Left"))1<this.j&&this.j--;else if(a.kMap("Right"))this.j<this.g.length&&this.j++;else if(g=a.kMap("Up")){this.o||(this.o=this.g);var k=this.W.prev(this.o);k?(this.g=k,this.j=k.length):e()}else(g=a.kMap("Down"))?(k=this.W.next(this.o))?(this.g=k,this.j=
k.length):this.o?(this.g=this.o,this.o=null):e():b=a.key}null!=b&&this.g.splice(this.j++,0,b);g||(this.W.reset(),this.o&&(this.o=this.g));a.cancel();this.a.feeder.dispatcher.dispatchEvent(new BotanEvent("VisualUpdate"))}};a.prototype.ab=function(a){this.W.push(this.g);var b="";switch(this.n){case "/":b="FIND";break;case ":":b="EDITOR_COMMAND"}var e=this.a;e.suppressEvent();this.a.openRunAction(b,a,this.g.slice());e.unsuppressEvent()};c[1](2,"Command",a)})();BotanJS.define("Components.Vim.Controls");
(function(){function a(a,b){this.kb=a;this.va=!1;if("string"==typeof b)this.Da=b,this.Ga=0,this.Z=f(b),this.Aa=27==this.Z;else{this.ga=b;if(";"==b.key||":"==b.key)m=b.keyCode;var e=this.ga.keyCode;this.Aa=27==e||b.ctrlKey&&67==e;this.Z=e+(b.shiftKey||b.getModifierState("CapsLock")?512:0)+(b.ctrlKey?1024:0)+(b.altKey?2048:0);this.Ga=16==e||17==e||18==e;this.Da=b.key}this.xa=1;this.K=null}function c(a){this.Ua=a;this.wa=a.contentFeeder;this.F=this.wa.cursor;this.k=null}function f(a){if(d[a])return d[a];
var b=a.split("-"),e=b[0],c=0;if(2==b.length){var f=!0;switch(b[0]){case "C":c=1024;break;case "A":c=2048;break;case "S":c=512;break;default:f=!1}f&&(e=b[1])}switch(e){case "BS":b=c+8;break;case "Del":b=c+46;break;case "Enter":b=c+13;break;case "Tab":b=c+9;break;case "Up":b=c+38;break;case "Down":b=c+40;break;case "Left":b=c+37;break;case "Right":b=c+39;break;case "A":c=512;case "a":b=c+65;break;case "B":c=512;case "b":b=c+66;break;case "C":c=512;case "c":b=c+67;break;case "D":c=512;case "d":b=c+
68;break;case "E":c=512;case "e":b=c+69;break;case "F":c=512;case "f":b=c+70;break;case "G":c=512;case "g":b=c+71;break;case "H":c=512;case "h":b=c+72;break;case "I":c=512;case "i":b=c+73;break;case "J":c=512;case "j":b=c+74;break;case "K":c=512;case "k":b=c+75;break;case "L":c=512;case "l":b=c+76;break;case "M":c=512;case "m":b=c+77;break;case "N":c=512;case "n":b=c+78;break;case "O":c=512;case "o":b=c+79;break;case "P":c=512;case "p":b=c+80;break;case "Q":c=512;case "q":b=c+81;break;case "R":c=
512;case "r":b=c+82;break;case "S":c=512;case "s":b=c+83;break;case "T":c=512;case "t":b=c+84;break;case "U":c=512;case "u":b=c+85;break;case "V":c=512;case "v":b=c+86;break;case "W":c=512;case "w":b=c+87;break;case "X":c=512;case "x":b=c+88;break;case "Y":c=512;case "y":b=c+89;break;case "Z":c=512;case "z":b=c+90;break;case "!":c=512;case "1":b=c+49;break;case "@":c=512;case "2":b=c+50;break;case "#":c=512;case "3":b=c+51;break;case "$":c=512;case "4":b=c+52;break;case "%":c=512;case "5":b=c+53;
break;case "^":c=512;case "6":b=c+54;break;case "&":c=512;case "7":b=c+55;break;case "*":c=512;case "8":b=c+56;break;case "(":c=512;case "9":b=c+57;break;case ")":c=512;case "0":b=c+48;break;case "<":c=512;case ",":b=c+188;break;case ">":c=512;case ".":b=c+190;break;default:throw Error("Unsupport keys: "+a);}return d[a]=b}var n=S("Components.Vim"),h=U("System.Debug"),e=U("Components.Vim.Ex.Command"),b=n[0]("Beep"),m=59,d={};c.prototype.d=function(a,c){if(c)this.i||(this.i=[]),this.i.push({keys:Array.prototype.slice.call(arguments,
2),handler:c,Va:0});else{for(var e=a.keyCode,d=0;d<this.i.length;d++){var f=this.i[d],h=f.keys,m=h[f.Va++];if(-1==m||m==e){f.Va==h.length&&(this.i=null,f.handler(a));return}}this.i&&b();this.i=null}};c.prototype.Xa=function(c){var d=this.F;switch(c.keyCode){case 577:d.lineEnd();case 65:d.moveX(1,!0,!0);case 73:d.openAction("INSERT",c);break;case 83:""!=d.e().content&&d.openRunAction("DELETE",c,d.aPos);d.openAction("INSERT",c);break;case 591:d.lineStart();d.openAction("INSERT",c);d.action.handler(new a(c.ub,
"Enter"));d.moveY(-1);break;case 79:d.lineEnd(!0);d.openAction("INSERT",c);d.action.handler(new a(c.ub,"Enter"));break;case 85:d.openRunAction("UNDO",c);break;case 1106:d.openRunAction("REDO",c);break;case 68:d.openAction("DELETE",c);break;case 89:d.openAction("YANK",c);break;case 80:d.suppressEvent(),d.moveX(1,!1,!0),d.unsuppressEvent();case 592:d.openRunAction("PUT",c);break;case 600:if(!this.T(-1))break;case 88:if(""==d.e().content){b();break}d.openRunAction("DELETE",c,d.aPos);break;case 586:d.openRunAction("JOIN_LINES",
c);break;case 86:case 598:d.openAction("VISUAL",c);d.action.handler(c);break;case 512+m:this.k=new e(d,":");this.k.handler(c);break;case 700:case 702:d.openAction("SHIFT_LINES",c)}};c.prototype.T=function(a,c){var e=this.F,d=e.X,f=e.Y;e.moveX(a,c,e.pSpace);return e.X==d&&e.Y==f?(b(),!1):!0};c.prototype.ta=function(a){var c=this.F,e=this.wa,d=c.Y+e.panY;c.moveY(a);d!=c.Y+e.panY||0<a&&!e.EOF||b()};c.prototype.$a=function(a){if(this.ia)a.preventDefault(),this.d(a);else{var b=this,c=!0;switch(a.keyCode){case 734:this.d(a,
function(a){a.target.Q.select(a.key);a.cancel();b.ia=!1},-1);break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:var e=a.key,d=function(a){var c=a.ModKeys;switch(a.keyCode){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e+=a.key,c=!0}c?(b.d(a,d,-1),a.cancel()):(a.xa=Number(e),h.Info("Count is: "+e),b.ia=!1)};this.d(a,d,-1);break;default:c=!1}(this.ia=c)&&a.cancel()}};c.prototype.ya=function(a){var c=a.keyCode;if(this.r&&!a.ModKeys)return this.d(a),
this.r=!1,!0;var d=this.F,f=d.feeder,h=!0;switch(c){case 8:this.T(-1,!0);break;case 72:this.T(-1);break;case 76:this.T(1);break;case 75:this.ta(-1);break;case 74:this.ta(1);break;case 1094:if(f.firstBuffer.nextLine.placeholder){b();break}f.pan(void 0,f.moreAt);f.softReset();d.moveY(-d.Y);break;case 1090:if(0==f.panY){b();break}f.pan(void 0,-f.moreAt);f.softReset();d.moveY(-d.Y);f.EOF||d.moveY(f.moreAt);break;case 584:break;case 588:break;case 48:d.lineStart();break;case 566:d.lineStart();break;case 564:d.lineEnd(d.pSpace);
break;case 583:d.moveY(Number.MAX_VALUE);d.moveX(Number.MAX_VALUE,!0);break;case 565:var m=this.Ua.contentAnalyzer,c=m.bracketAt(d.aPos);if(-1==c.open){b();break}d.moveTo(c.selected==c.close?c.open:c.close);break;case 596:case 84:this.r=!0;this.d(a,function(b){var c=d.X;d.openRunAction("TO",a,b);d.X<c?d.moveX(1):c<d.X&&d.moveX(-1)},-1);break;case 582:case 70:this.r=!0;this.d(a,function(b){d.openRunAction("TO",a,b)},-1);break;case 87:case 599:case 66:case 578:d.openRunAction("WORD",a);break;case 73:if(!d.action){h=
!1;break}m=this.Ua.contentAnalyzer;this.r=!0;this.d(a,function(a){var b=m.wordAt(d.aPos);a.K=b},87);var c=function(a){var b=m.bracketIn("(",d.aPos);a.K=b},f=function(a){var b=m.bracketIn("{",d.aPos);a.K=b},n=function(a){var b=m.bracketIn("[",d.aPos);a.K=b};this.d(a,c,560);this.d(a,c,569);this.d(a,n,219);this.d(a,n,221);this.d(a,f,731);this.d(a,f,733);break;case 71:this.r=!0;this.d(a,function(){d.moveY(-Number.MAX_VALUE);d.moveX(-Number.MAX_VALUE,!0)},71);this.d(a,function(){d.openRunAction("PRINT_HEX",
a)},56);this.d(a,function(){d.action&&b()},85);this.d(a,function(){d.action&&b()},597);break;case 590:case 78:d.openRunAction("FIND",a);break;case 191:this.r=!0;this.k=new e(d,"/");this.k.handler(a);break;default:h=!1}return h};c.prototype.handler=function(a,c){if(!(2116==c.keyCode||112<c.keyCode&&123>=c.keyCode)){if(c.Escape){var d=!1;this.r=!1;this.i?(d=!0,this.i=null):this.k&&(d=!0,this.k.dispose(),this.k=null);if(d){b();return}}if(this.k&&(this.k.handler(c)&&(this.k.dispose(),this.r=!1,this.k=
null),c.canceled))return;this.$a(c);if(!c.canceled)if(d=this.F,d.action)if(c.Escape)c.preventDefault(),d.closeAction();else{if(d.action.allowMovement){var e=!this.i;this.ya(c);if(e&&this.i){c.preventDefault();return}}d.action.handler(c)&&d.closeAction()}else c.preventDefault(),this.ya(c)||this.Xa(c)}};s(a.prototype,"target",function(){return this.kb});s(a.prototype,"key",function(){return this.Da});s(a.prototype,"keyCode",function(){return this.Z});s(a.prototype,"ModKeys",function(){return this.Ga});
s(a.prototype,"Escape",function(){return this.Aa});s(a.prototype,"canceled",function(){return this.va});s(a.prototype,"range",function(){var a=this.K;return a&&-1==a.open&&-1==a.close?null:a});s(a.prototype,"count",function(){return this.xa});a.prototype.kMap=function(a){return this.Z==f(a)};a.prototype.cancel=function(){this.preventDefault();this.va=!0};a.prototype.preventDefault=function(){this.ga&&this.ga.preventDefault()};n[1](2,"Controls",c);n[1](2,"ActionEvent",a)})();BotanJS.define("Components.Vim.VimArea");
(function(){function a(a,b){if(!a)throw Error("Invalid argument");a=n(a);var c=a.element;if(!c||"TEXTAREA"!=c.nodeName)throw Error("This element is not compatible for VimArea");for(var d in t){var f=t[d];if(f.stage.element==c)return m.Info("Instance exists"),f}a.setAttribute(new h("vimarea",1));this.stage=a;this.rows=c.rows;this.cols=c.cols;this.S=!1;var g=this;this.oa=[new e("Focus",function(){g.S=!0}),new e("Blur",function(){g.S=!1})];if(b){var k=c.value;this.lb(function(){g.ra(k)})}else this.ra(c.value);
this.ha=x++;t[this.ha]=this}function c(a,b){return function(c){a.S=!0;c=c||window.event;c.keyCode?code=c.keyCode:c.which&&(code=c.which);b(a,new v(a,c))}}var f=S("Components.Vim"),n=U("Dandelion.IDOMElement"),h=U("System.utils.DataKey"),e=U("System.utils.EventKey"),b=U("System.Cycle"),m=U("System.Debug"),d=U("Components.Vim.State.Registers"),g=U("Components.Vim.Syntax.Analyzer"),k=f[0]("LineFeeder"),M=f[0]("StatusBar"),p=f[0]("Controls"),v=f[0]("ActionEvent"),u=f[0]("Message"),t=[],x=0;a.prototype.lb=
function(a){function c(){f.value+=e();++m;k==f.scrollHeight?b.next(c):(n.rows=m,n.cols=g,a())}function d(){f.value+=e();if(h==f.scrollWidth)b.next(d);else{var a="";--g;for(var k=0;k<g;k++)a+=".";f.value=a;f.style.whiteSpace="";e=function(){return"\n"+a};c()}}function e(){return"Please wait while Vim;Re is testing for screen dimensions"[g++]||"."}var f=this.stage.element;f.value="";var g=0;f.style.whiteSpace="nowrap";var h=f.scrollWidth;d();var k=f.scrollHeight,m=0,n=this};a.prototype.select=function(a){if(this.S){var b=
this.stage.element;a&&(b.selectionStart=a.start,b.selectionEnd=a.end)}};a.prototype.ra=function(a){function f(){y.init(B.statusText);var a=y.linesOccupied;m.value=v.render(a-1,n-a)+"\n"+y.render(0,a<n?a:n);h.D=!1;h.select(v.cursor.position)}var h=this;this.content=a;var m=this.stage.element,n=this.rows,t=this.cols,v=new k(n-1,t),x=new g(v);v.init(a+"\n");var y=new k(n,t);y.setRender(!1);v.cursor.Vim=this;y.cursor.Vim=this;var B=new M(t);B.stamp(-18,function(){return v.lineStat});B.stamp(-3,function(){return u(v.docPos)});
B.stamp(0,function(){return v.cursor.message});y.init(B.statusText);v.dispatcher.addEventListener("SelectionChanged",function(){h.select(v.cursor.position)});v.dispatcher.addEventListener("VisualUpdate",f);m.value="Please wait ...";b.delay(f,70);this.C=f;this.contentFeeder=v;this.contentAnalyzer=x;this.statusFeeder=y;this.statusBar=B;this.Q=new d;this.a=v.cursor;this.D=!0;b.perma("VimCursorBlinkCycle"+m.id,function(){h.select(!h.a.blink||(h.D=!h.D)?h.a.position:{start:0,end:0})},600);a=new p(this);
this.oa.push(new e("KeyDown",c(this,a.handler.bind(a))));this.stage.addEventListeners(this.oa)};a.prototype.dispose=function(){var a=this.stage,c=this.oa,d=this.contentFeeder,e=a.element.id;m.Info("Destroy instance: "+e);d.dispatcher.removeEventListener("VisualUpdate",this.C);a.removeAttribute("data-vimarea");b.permaRemove("VimCursorBlinkCycle"+e);for(var f in c)a.removeEventListener(c[f]);a.element.value=this.content;delete t[this.ha]};s(a.prototype,"index",function(){return this.ha+1});s(a,"Instances",
function(){var a=[],b;for(b in t)a.push(t[b]);return a});f[1](2,"VimArea",a)})();})();
